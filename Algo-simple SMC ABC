{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 69,
   "id": "12b413b6-1b6a-4594-bed6-caae6144f0e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "import scipy.integrate as integrate\n",
    "from scipy.stats import uniform, norm\n",
    "import scipy.stats as sps\n",
    "from random import choices\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "ef4ee381-8c34-4470-a99a-9169cd7f4948",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[31mERROR: Could not find a version that satisfies the requirement gk (from versions: none)\u001b[0m\u001b[31m\n",
      "\u001b[0m\u001b[31mERROR: No matching distribution found for gk\u001b[0m\u001b[31m\n",
      "\u001b[0m"
     ]
    }
   ],
   "source": [
    "!pip install gk"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "59e04b60-87b4-4cb8-9fb5-e4bb16f72930",
   "metadata": {},
   "outputs": [],
   "source": [
    "def changementeps(distances, eps, poids, alpha, n):\n",
    "    epsilons = np.sort(distances[distances<eps])[::-1]\n",
    "    nbops = len(epsilons)\n",
    "    print(\"nbops\")\n",
    "    print(nbops)\n",
    "    ESS = 1/sum(poids**2)\n",
    "    k = 0\n",
    "    nouvpoids = poids\n",
    "    while (k<nbops-1):\n",
    "        nouveps = epsilons[k]\n",
    "        a=True\n",
    "        for i in range(n):\n",
    "            if (poids[i] != 0) :   \n",
    "                if (distances[i] > eps) or (distances[i] > nouveps):\n",
    "                    nouvpoids[i]=0\n",
    "                else:\n",
    "                    nouvpoids[i] = 1/distances[i]\n",
    "        nouvpoids = nouvpoids / sum(nouvpoids)\n",
    "        nouvESS = 1/sum(nouvpoids**2)\n",
    "        if nouvESS < (alpha * ESS) :\n",
    "            return(nouveps,nouvpoids,nouvESS)\n",
    "        k += 1\n",
    "    return(eps,poids,ESS)\n",
    "\n",
    "def chgtpar(simui, distancesi, sd, eps, data, dprior, dist, n,i):\n",
    "    var = np.random.multivariate_normal(np.zeros(len(sd)),cov=sd)\n",
    "    nsimu = simui + np.append(np.mean(var),var)\n",
    "    comp = dprior(nsimu)\n",
    "    #for i in range(4):\n",
    "       # nnsimu = simui + np.append(np.mean(var),np.random.multivariate_normal(np.zeros(len(sd)),cov=sd))\n",
    "       # dens = dprior(nnsimu)\n",
    "       # nndistances = dist(nnsimu)\n",
    "       # if (nndistances <= eps) and (dens>comp):\n",
    "       #     comp = dens\n",
    "       #     nsimu = nnsimu\n",
    "    ndistances = dist(nsimu)\n",
    "    u = np.random.uniform(1)\n",
    "    if i==0:\n",
    "        print(\"prior\")\n",
    "        print(dprior(nsimu))\n",
    "        print(dprior(simui))\n",
    "    if ndistances>eps :\n",
    "        return(simui, distancesi)\n",
    "    elif distancesi > eps :\n",
    "        return(nsimu, ndistances)\n",
    "    elif (u < distancesi / ndistances):# * comp / dprior(simui)):\n",
    "        print(\"C\")\n",
    "        return(nsimu, ndistances)\n",
    "    else :\n",
    "        return(simui, distancesi)\n",
    "\n",
    "def smc(data, n, T, objectifeps, alpha, rprior, dprior, dist, l):\n",
    "    simu = rprior(n)\n",
    "    distances = np.apply_along_axis(dist,1,simu)\n",
    "    print(distances)\n",
    "    j=1\n",
    "    poids = np.array([1/n]*n)\n",
    "    ESS = n\n",
    "    eps = np.max(distances)\n",
    "    histeps = [eps]\n",
    "    print(\"simu\")\n",
    "    print(simu)\n",
    "    while ((j<T) and (eps>objectifeps)):\n",
    "        (eps, poids, ESS) = changementeps(distances, eps, poids, alpha, n)\n",
    "        histeps.append(eps)\n",
    "        if (ESS < (1/2*n)) :\n",
    "            simu = np.array(choices(simu, weights = poids, k = n))\n",
    "            poids = np.array([1/n]*n)\n",
    "            ESS = n\n",
    "            distances = np.apply_along_axis(dist,1,simu)\n",
    "        sd = 2*np.cov(np.transpose(simu[:,1:l+1]))\n",
    "        for i in range(n):\n",
    "            if (poids[i] > 0) :\n",
    "                simu[i], distances[i] = chgtpar(simu[i], distances[i], sd, eps, data, dprior, dist, n,i)\n",
    "        print(j,eps)\n",
    "        print(\"simu\")\n",
    "        print(simu)\n",
    "        j += 1\n",
    "    simu = choices(simu, weights = poids, k = n)\n",
    "    #poids = np.array([1/n]*n)\n",
    "    ESS = n\n",
    "    distances = np.apply_along_axis(dist,1,simu)\n",
    "    return(simu, poids, distances, histeps)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5065709f-6b8a-46d0-84c1-13ce3abbf169",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[389.99985139 386.3012259  401.62856479 481.53521827 405.29685826\n",
      " 371.01060563 453.3967136  471.62389409 373.12300723 493.17444459\n",
      " 411.53245294 401.17123042 462.31594472 486.38760088 531.55002441\n",
      " 504.74404617 449.55862191 471.4840879  484.34730656 437.13168041\n",
      " 368.28266494 373.35604222 490.70655402 493.91722755 377.66653171\n",
      " 410.73246492 388.17106338 451.5663946  409.40774673 452.53229771\n",
      " 335.65527521 469.10442978 404.74904216 609.33699631 364.29405418\n",
      " 380.51408272 411.24111406 379.81548988 421.88560436 444.81058822\n",
      " 391.63014198 348.91066796 429.70811558 460.50787346 502.26614802\n",
      " 373.45436651 390.46965521 413.4085912  472.83030834 400.01620166]\n",
      "simu\n",
      "[[5.40138547 5.59436753 5.69970339 ... 4.04971572 3.9156638  5.30362293]\n",
      " [4.64583983 3.84875519 4.11766898 ... 4.0869545  2.58919325 3.99950305]\n",
      " [4.30460798 6.5043562  5.08679399 ... 5.17749777 4.06315443 3.46689238]\n",
      " ...\n",
      " [5.44807814 4.32107775 5.14400911 ... 6.04374762 5.53687406 5.84455729]\n",
      " [5.96047683 5.9040898  7.36103506 ... 6.76954453 4.93470007 4.97912143]\n",
      " [5.32038249 6.78931466 5.57986761 ... 4.4033715  5.68586146 3.39539771]]\n",
      "nbops\n",
      "49\n",
      "prior\n",
      "9.091160883316746\n",
      "13.994560424861698\n",
      "1 484.3473065618224\n",
      "simu\n",
      "[[5.40138547 5.59436753 5.69970339 ... 4.04971572 3.9156638  5.30362293]\n",
      " [4.64583983 3.84875519 4.11766898 ... 4.0869545  2.58919325 3.99950305]\n",
      " [4.30460798 6.5043562  5.08679399 ... 5.17749777 4.06315443 3.46689238]\n",
      " ...\n",
      " [5.44807814 4.32107775 5.14400911 ... 6.04374762 5.53687406 5.84455729]\n",
      " [5.96047683 5.9040898  7.36103506 ... 6.76954453 4.93470007 4.97912143]\n",
      " [5.32038249 6.78931466 5.57986761 ... 4.4033715  5.68586146 3.39539771]]\n",
      "nbops\n",
      "41\n",
      "prior\n",
      "9.372681341095747\n",
      "13.994560424861698\n",
      "2 460.5078734566703\n",
      "simu\n",
      "[[5.40138547 5.59436753 5.69970339 ... 4.04971572 3.9156638  5.30362293]\n",
      " [4.64583983 3.84875519 4.11766898 ... 4.0869545  2.58919325 3.99950305]\n",
      " [4.30460798 6.5043562  5.08679399 ... 5.17749777 4.06315443 3.46689238]\n",
      " ...\n",
      " [5.44807814 4.32107775 5.14400911 ... 6.04374762 5.53687406 5.84455729]\n",
      " [5.96047683 5.9040898  7.36103506 ... 6.76954453 4.93470007 4.97912143]\n",
      " [5.32038249 6.78931466 5.57986761 ... 4.4033715  5.68586146 3.39539771]]\n",
      "nbops\n",
      "34\n",
      "prior\n",
      "10.090367002947426\n",
      "13.994560424861698\n",
      "3 437.13168041384324\n",
      "simu\n",
      "[[5.40138547 5.59436753 5.69970339 ... 4.04971572 3.9156638  5.30362293]\n",
      " [4.64583983 3.84875519 4.11766898 ... 4.0869545  2.58919325 3.99950305]\n",
      " [4.30460798 6.5043562  5.08679399 ... 5.17749777 4.06315443 3.46689238]\n",
      " ...\n",
      " [5.44807814 4.32107775 5.14400911 ... 6.04374762 5.53687406 5.84455729]\n",
      " [5.96047683 5.9040898  7.36103506 ... 6.76954453 4.93470007 4.97912143]\n",
      " [5.32038249 6.78931466 5.57986761 ... 4.4033715  5.68586146 3.39539771]]\n",
      "nbops\n",
      "28\n",
      "prior\n",
      "11.347949174331236\n",
      "13.71548198172159\n",
      "C\n",
      "4 411.24111406074746\n",
      "simu\n",
      "[[5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [5.40138547 5.59436753 5.69970339 ... 4.04971572 3.9156638  5.30362293]\n",
      " [4.30460798 6.5043562  5.08679399 ... 5.17749777 4.06315443 3.46689238]\n",
      " ...\n",
      " [5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [5.44040082 5.24458626 7.3354657  ... 6.84546868 6.84651536 4.90203633]\n",
      " [5.44040082 5.24458626 7.3354657  ... 6.84546868 6.84651536 4.90203633]]\n",
      "nbops\n",
      "47\n",
      "prior\n",
      "8.589316254447073\n",
      "13.71548198172159\n",
      "5 405.2968582620599\n",
      "simu\n",
      "[[5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [5.40138547 5.59436753 5.69970339 ... 4.04971572 3.9156638  5.30362293]\n",
      " [4.30460798 6.5043562  5.08679399 ... 5.17749777 4.06315443 3.46689238]\n",
      " ...\n",
      " [5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [5.44040082 5.24458626 7.3354657  ... 6.84546868 6.84651536 4.90203633]\n",
      " [5.44040082 5.24458626 7.3354657  ... 6.84546868 6.84651536 4.90203633]]\n",
      "nbops\n",
      "40\n",
      "prior\n",
      "8.332727876200074\n",
      "13.71548198172159\n",
      "6 400.01620165592345\n",
      "simu\n",
      "[[5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [5.40138547 5.59436753 5.69970339 ... 4.04971572 3.9156638  5.30362293]\n",
      " [4.30460798 6.5043562  5.08679399 ... 5.17749777 4.06315443 3.46689238]\n",
      " ...\n",
      " [5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [5.44040082 5.24458626 7.3354657  ... 6.84546868 6.84651536 4.90203633]\n",
      " [5.44040082 5.24458626 7.3354657  ... 6.84546868 6.84651536 4.90203633]]\n",
      "nbops\n",
      "33\n",
      "prior\n",
      "9.669737207492528\n",
      "13.71548198172159\n",
      "7 380.5140827203818\n",
      "simu\n",
      "[[5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [5.40138547 5.59436753 5.69970339 ... 4.04971572 3.9156638  5.30362293]\n",
      " [4.30460798 6.5043562  5.08679399 ... 5.17749777 4.06315443 3.46689238]\n",
      " ...\n",
      " [5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [5.44040082 5.24458626 7.3354657  ... 6.84546868 6.84651536 4.90203633]\n",
      " [5.44040082 5.24458626 7.3354657  ... 6.84546868 6.84651536 4.90203633]]\n",
      "nbops\n",
      "27\n",
      "prior\n",
      "11.735474885222601\n",
      "14.504787169691586\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "8 373.4543665058916\n",
      "simu\n",
      "[[5.25072942 5.60332978 5.02846854 ... 4.1100945  5.18862563 5.9938995 ]\n",
      " [5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [4.73758092 3.94881092 4.78557171 ... 5.00391227 3.70132833 6.55627529]\n",
      " ...\n",
      " [4.49268057 5.00429087 3.54239448 ... 5.11001666 3.56174239 5.74089224]\n",
      " [5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [5.46266638 5.41881438 7.52732818 ... 5.25228227 4.65290907 5.40188721]]\n",
      "nbops\n",
      "44\n",
      "prior\n",
      "7.6957857002419034\n",
      "14.504787169691586\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "9 373.3560422173582\n",
      "simu\n",
      "[[5.25072942 5.60332978 5.02846854 ... 4.1100945  5.18862563 5.9938995 ]\n",
      " [4.64951741 4.96182793 4.19666372 ... 5.69145076 3.33517362 4.98033379]\n",
      " [4.73758092 3.94881092 4.78557171 ... 5.00391227 3.70132833 6.55627529]\n",
      " ...\n",
      " [4.49268057 5.00429087 3.54239448 ... 5.11001666 3.56174239 5.74089224]\n",
      " [5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [5.3688639  4.63868959 6.18540918 ... 5.30198195 4.43911473 5.08689771]]\n",
      "nbops\n",
      "42\n",
      "C\n",
      "C\n",
      "C\n",
      "10 371.0106056270463\n",
      "simu\n",
      "[[5.25072942 5.60332978 5.02846854 ... 4.1100945  5.18862563 5.9938995 ]\n",
      " [4.64951741 4.96182793 4.19666372 ... 5.69145076 3.33517362 4.98033379]\n",
      " [4.73758092 3.94881092 4.78557171 ... 5.00391227 3.70132833 6.55627529]\n",
      " ...\n",
      " [4.49268057 5.00429087 3.54239448 ... 5.11001666 3.56174239 5.74089224]\n",
      " [5.34152853 3.92958002 4.86004884 ... 5.37554926 4.29710965 3.6003533 ]\n",
      " [5.3688639  4.63868959 6.18540918 ... 5.30198195 4.43911473 5.08689771]]\n",
      "nbops\n",
      "25\n",
      "prior\n",
      "8.821242295437129\n",
      "15.037138611231441\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "11 368.2826649444954\n",
      "simu\n",
      "[[5.15208594 4.69395573 5.15673341 ... 4.39560181 5.23860182 3.93331882]\n",
      " [4.95647697 5.15929448 4.8888349  ... 4.93679469 4.14342508 5.9714842 ]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " ...\n",
      " [5.3688639  4.63868959 6.18540918 ... 5.30198195 4.43911473 5.08689771]\n",
      " [4.87307861 5.58054443 5.67925334 ... 5.06781056 4.65000304 3.98779864]\n",
      " [4.64951741 4.96182793 4.19666372 ... 5.69145076 3.33517362 4.98033379]]\n",
      "nbops\n",
      "47\n",
      "prior\n",
      "12.826422198190523\n",
      "15.037138611231441\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "12 352.7357333173451\n",
      "simu\n",
      "[[5.15208594 4.69395573 5.15673341 ... 4.39560181 5.23860182 3.93331882]\n",
      " [4.95647697 5.15929448 4.8888349  ... 4.93679469 4.14342508 5.9714842 ]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " ...\n",
      " [5.3688639  4.63868959 6.18540918 ... 5.30198195 4.43911473 5.08689771]\n",
      " [4.87307861 5.58054443 5.67925334 ... 5.06781056 4.65000304 3.98779864]\n",
      " [4.64951741 4.96182793 4.19666372 ... 5.69145076 3.33517362 4.98033379]]\n",
      "nbops\n",
      "43\n",
      "prior\n",
      "12.47833967406194\n",
      "15.037138611231441\n",
      "C\n",
      "13 326.26442569348256\n",
      "simu\n",
      "[[5.15208594 4.69395573 5.15673341 ... 4.39560181 5.23860182 3.93331882]\n",
      " [4.95647697 5.15929448 4.8888349  ... 4.93679469 4.14342508 5.9714842 ]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " ...\n",
      " [5.3688639  4.63868959 6.18540918 ... 5.30198195 4.43911473 5.08689771]\n",
      " [4.87307861 5.58054443 5.67925334 ... 5.06781056 4.65000304 3.98779864]\n",
      " [4.64951741 4.96182793 4.19666372 ... 5.69145076 3.33517362 4.98033379]]\n",
      "nbops\n",
      "35\n",
      "C\n",
      "C\n",
      "C\n",
      "14 311.00889531486763\n",
      "simu\n",
      "[[5.15208594 4.69395573 5.15673341 ... 4.39560181 5.23860182 3.93331882]\n",
      " [4.95647697 5.15929448 4.8888349  ... 4.93679469 4.14342508 5.9714842 ]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " ...\n",
      " [5.3696349  4.34340497 5.70240172 ... 5.25473574 4.48469806 4.58700653]\n",
      " [4.87307861 5.58054443 5.67925334 ... 5.06781056 4.65000304 3.98779864]\n",
      " [4.64951741 4.96182793 4.19666372 ... 5.69145076 3.33517362 4.98033379]]\n",
      "nbops\n",
      "28\n",
      "prior\n",
      "15.800968823777499\n",
      "16.456359340679903\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "15 299.33823285339844\n",
      "simu\n",
      "[[5.3696349  4.34340497 5.70240172 ... 5.25473574 4.48469806 4.58700653]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " ...\n",
      " [4.77669474 4.49233845 5.09662277 ... 4.73692578 4.40004819 4.73906352]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]]\n",
      "nbops\n",
      "50\n",
      "prior\n",
      "14.835046534472182\n",
      "16.456359340679903\n",
      "C\n",
      "C\n",
      "16 277.48058494316024\n",
      "simu\n",
      "[[5.3696349  4.34340497 5.70240172 ... 5.25473574 4.48469806 4.58700653]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " ...\n",
      " [4.77669474 4.49233845 5.09662277 ... 4.73692578 4.40004819 4.73906352]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]]\n",
      "nbops\n",
      "42\n",
      "prior\n",
      "13.422953694764988\n",
      "16.456359340679903\n",
      "C\n",
      "C\n",
      "17 247.79098269320951\n",
      "simu\n",
      "[[5.3696349  4.34340497 5.70240172 ... 5.25473574 4.48469806 4.58700653]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " ...\n",
      " [4.77669474 4.49233845 5.09662277 ... 4.73692578 4.40004819 4.73906352]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]]\n",
      "nbops\n",
      "35\n",
      "prior\n",
      "13.912643090235596\n",
      "16.456359340679903\n",
      "C\n",
      "18 240.1380273258691\n",
      "simu\n",
      "[[5.3696349  4.34340497 5.70240172 ... 5.25473574 4.48469806 4.58700653]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " ...\n",
      " [4.77669474 4.49233845 5.09662277 ... 4.73692578 4.40004819 4.73906352]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]]\n",
      "nbops\n",
      "29\n",
      "prior\n",
      "17.837379032899282\n",
      "18.400514848384187\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "19 207.16302750953872\n",
      "simu\n",
      "[[4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.97630611 4.73996895 5.11922668 ... 4.59469856 4.68258791 5.57211115]\n",
      " [4.66592994 4.2709443  4.41127431 ... 5.14151219 3.8399348  4.99016112]\n",
      " ...\n",
      " [5.1014908  4.97213454 5.0041144  ... 4.95499904 4.37044591 4.88758772]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]]\n",
      "nbops\n",
      "49\n",
      "prior\n",
      "18.53443186114221\n",
      "18.400514848384187\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "20 176.8748649668899\n",
      "simu\n",
      "[[4.90957948 4.59241115 5.16597636 ... 4.71825667 4.44387852 5.34299499]\n",
      " [4.97630611 4.73996895 5.11922668 ... 4.59469856 4.68258791 5.57211115]\n",
      " [4.66592994 4.2709443  4.41127431 ... 5.14151219 3.8399348  4.99016112]\n",
      " ...\n",
      " [5.1014908  4.97213454 5.0041144  ... 4.95499904 4.37044591 4.88758772]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]]\n",
      "nbops\n",
      "41\n",
      "prior\n",
      "18.102690213481562\n",
      "18.53443186114221\n",
      "C\n",
      "C\n",
      "21 148.53570724581084\n",
      "simu\n",
      "[[4.90957948 4.59241115 5.16597636 ... 4.71825667 4.44387852 5.34299499]\n",
      " [4.97630611 4.73996895 5.11922668 ... 4.59469856 4.68258791 5.57211115]\n",
      " [4.66592994 4.2709443  4.41127431 ... 5.14151219 3.8399348  4.99016112]\n",
      " ...\n",
      " [5.1014908  4.97213454 5.0041144  ... 4.95499904 4.37044591 4.88758772]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]\n",
      " [4.82391492 4.46164435 5.11607926 ... 4.93760411 4.22082582 5.31720724]]\n",
      "nbops\n",
      "33\n",
      "prior\n",
      "18.601258305179577\n",
      "18.372232941897586\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "22 143.84155093397808\n",
      "simu\n",
      "[[4.87305689 4.83063056 4.88437441 ... 4.800544   4.44548712 5.09939165]\n",
      " [4.83577239 4.80394914 5.43346503 ... 4.91259111 4.38363314 4.95604876]\n",
      " [4.90767309 5.02930998 5.37845369 ... 4.99197944 4.45569024 4.79812222]\n",
      " ...\n",
      " [5.09627016 4.86988942 4.94548441 ... 4.95777738 4.33571184 4.93399869]\n",
      " [4.90957948 4.59241115 5.16597636 ... 4.71825667 4.44387852 5.34299499]\n",
      " [4.89790677 4.9392421  5.1526558  ... 4.94953384 4.4311002  4.86037861]]\n",
      "nbops\n",
      "47\n",
      "prior\n",
      "18.523523743879895\n",
      "18.601258305179577\n",
      "C\n",
      "C\n",
      "23 140.7252315946738\n",
      "simu\n",
      "[[4.87305689 4.83063056 4.88437441 ... 4.800544   4.44548712 5.09939165]\n",
      " [4.83577239 4.80394914 5.43346503 ... 4.91259111 4.38363314 4.95604876]\n",
      " [4.90767309 5.02930998 5.37845369 ... 4.99197944 4.45569024 4.79812222]\n",
      " ...\n",
      " [5.09627016 4.86988942 4.94548441 ... 4.95777738 4.33571184 4.93399869]\n",
      " [4.90957948 4.59241115 5.16597636 ... 4.71825667 4.44387852 5.34299499]\n",
      " [4.88900437 4.65183421 4.94217277 ... 4.79864579 4.39207521 5.2146241 ]]\n",
      "nbops\n",
      "36\n",
      "prior\n",
      "18.10471636539432\n",
      "18.601258305179577\n",
      "24 138.46216248942682\n",
      "simu\n",
      "[[4.87305689 4.83063056 4.88437441 ... 4.800544   4.44548712 5.09939165]\n",
      " [4.83577239 4.80394914 5.43346503 ... 4.91259111 4.38363314 4.95604876]\n",
      " [4.90767309 5.02930998 5.37845369 ... 4.99197944 4.45569024 4.79812222]\n",
      " ...\n",
      " [5.09627016 4.86988942 4.94548441 ... 4.95777738 4.33571184 4.93399869]\n",
      " [4.90957948 4.59241115 5.16597636 ... 4.71825667 4.44387852 5.34299499]\n",
      " [4.88900437 4.65183421 4.94217277 ... 4.79864579 4.39207521 5.2146241 ]]\n",
      "nbops\n",
      "25\n",
      "prior\n",
      "18.46774784978379\n",
      "18.637062441833905\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "25 137.70650375993978\n",
      "simu\n",
      "[[4.89875447 4.55038902 4.84357124 ... 4.75087938 4.40742634 5.43591491]\n",
      " [4.90631566 4.87140024 5.14176226 ... 5.04376254 4.36712063 4.87174836]\n",
      " [4.81431122 4.63207518 5.23979379 ... 5.05371032 4.21513524 4.98229215]\n",
      " ...\n",
      " [4.84699444 4.83230077 5.14719612 ... 4.95235416 4.35017816 4.88035376]\n",
      " [4.90631566 4.87140024 5.14176226 ... 5.04376254 4.36712063 4.87174836]\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]]\n",
      "nbops\n",
      "47\n",
      "prior\n",
      "18.52515938771377\n",
      "18.637062441833905\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "26 137.00563374951426\n",
      "simu\n",
      "[[4.89875447 4.55038902 4.84357124 ... 4.75087938 4.40742634 5.43591491]\n",
      " [4.90631566 4.87140024 5.14176226 ... 5.04376254 4.36712063 4.87174836]\n",
      " [4.81431122 4.63207518 5.23979379 ... 5.05371032 4.21513524 4.98229215]\n",
      " ...\n",
      " [4.84699444 4.83230077 5.14719612 ... 4.95235416 4.35017816 4.88035376]\n",
      " [4.90631566 4.87140024 5.14176226 ... 5.04376254 4.36712063 4.87174836]\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]]\n",
      "nbops\n",
      "36\n",
      "prior\n",
      "18.261343682592617\n",
      "18.637062441833905\n",
      "C\n",
      "C\n",
      "C\n",
      "27 135.07790957755643\n",
      "simu\n",
      "[[4.89875447 4.55038902 4.84357124 ... 4.75087938 4.40742634 5.43591491]\n",
      " [4.90631566 4.87140024 5.14176226 ... 5.04376254 4.36712063 4.87174836]\n",
      " [4.81431122 4.63207518 5.23979379 ... 5.05371032 4.21513524 4.98229215]\n",
      " ...\n",
      " [4.84699444 4.83230077 5.14719612 ... 4.95235416 4.35017816 4.88035376]\n",
      " [4.90631566 4.87140024 5.14176226 ... 5.04376254 4.36712063 4.87174836]\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]]\n",
      "nbops\n",
      "31\n",
      "prior\n",
      "18.562174531971525\n",
      "18.508073736606764\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "28 133.25377407002134\n",
      "simu\n",
      "[[5.09627016 4.86988942 4.94548441 ... 4.95777738 4.33571184 4.93399869]\n",
      " [5.15744623 4.75711289 5.02387781 ... 4.92890504 4.39099648 5.02786077]\n",
      " [4.88900437 4.65183421 4.94217277 ... 4.79864579 4.39207521 5.2146241 ]\n",
      " ...\n",
      " [5.09627016 4.86988942 4.94548441 ... 4.95777738 4.33571184 4.93399869]\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]\n",
      " [4.88900437 4.65183421 4.94217277 ... 4.79864579 4.39207521 5.2146241 ]]\n",
      "nbops\n",
      "48\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "29 130.23493432272656\n",
      "simu\n",
      "[[5.09627016 4.86988942 4.94548441 ... 4.95777738 4.33571184 4.93399869]\n",
      " [5.15744623 4.75711289 5.02387781 ... 4.92890504 4.39099648 5.02786077]\n",
      " [4.88900437 4.65183421 4.94217277 ... 4.79864579 4.39207521 5.2146241 ]\n",
      " ...\n",
      " [5.09627016 4.86988942 4.94548441 ... 4.95777738 4.33571184 4.93399869]\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]\n",
      " [4.87656437 4.75482879 5.10967892 ... 4.78173455 4.4671705  5.05175797]]\n",
      "nbops\n",
      "33\n",
      "C\n",
      "30 126.5285973153485\n",
      "simu\n",
      "[[5.09627016 4.86988942 4.94548441 ... 4.95777738 4.33571184 4.93399869]\n",
      " [5.15744623 4.75711289 5.02387781 ... 4.92890504 4.39099648 5.02786077]\n",
      " [4.88900437 4.65183421 4.94217277 ... 4.79864579 4.39207521 5.2146241 ]\n",
      " ...\n",
      " [5.09627016 4.86988942 4.94548441 ... 4.95777738 4.33571184 4.93399869]\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]\n",
      " [4.87656437 4.75482879 5.10967892 ... 4.78173455 4.4671705  5.05175797]]\n",
      "nbops\n",
      "27\n",
      "prior\n",
      "18.56891582670542\n",
      "18.83949721611428\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "31 124.40036314325394\n",
      "simu\n",
      "[[4.88243242 4.69482769 5.17376633 ... 4.92183787 4.35737136 5.15328746]\n",
      " [4.87185288 4.84872337 5.13796275 ... 4.90211693 4.40278614 5.00933994]\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]\n",
      " ...\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]\n",
      " [4.8427807  4.74290926 5.11286618 ... 4.7330824  4.47465336 5.12899572]\n",
      " [4.87185288 4.84872337 5.13796275 ... 4.90211693 4.40278614 5.00933994]]\n",
      "nbops\n",
      "41\n",
      "prior\n",
      "18.33920153135531\n",
      "18.83949721611428\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "32 124.29378252005182\n",
      "simu\n",
      "[[4.88243242 4.69482769 5.17376633 ... 4.92183787 4.35737136 5.15328746]\n",
      " [4.87185288 4.84872337 5.13796275 ... 4.90211693 4.40278614 5.00933994]\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]\n",
      " ...\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]\n",
      " [4.8427807  4.74290926 5.11286618 ... 4.7330824  4.47465336 5.12899572]\n",
      " [4.87185288 4.84872337 5.13796275 ... 4.90211693 4.40278614 5.00933994]]\n",
      "nbops\n",
      "39\n",
      "prior\n",
      "18.136549675459325\n",
      "18.83949721611428\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "33 121.70415567631437\n",
      "simu\n",
      "[[4.88243242 4.69482769 5.17376633 ... 4.92183787 4.35737136 5.15328746]\n",
      " [4.87185288 4.84872337 5.13796275 ... 4.90211693 4.40278614 5.00933994]\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]\n",
      " ...\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]\n",
      " [4.8427807  4.74290926 5.11286618 ... 4.7330824  4.47465336 5.12899572]\n",
      " [4.87185288 4.84872337 5.13796275 ... 4.90211693 4.40278614 5.00933994]]\n",
      "nbops\n",
      "29\n",
      "prior\n",
      "18.67343443142039\n",
      "18.83949721611428\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "34 121.2138609828968\n",
      "simu\n",
      "[[4.88243242 4.69482769 5.17376633 ... 4.92183787 4.35737136 5.15328746]\n",
      " [4.87185288 4.84872337 5.13796275 ... 4.90211693 4.40278614 5.00933994]\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]\n",
      " ...\n",
      " [4.85670374 4.6576723  4.94270091 ... 4.89871255 4.33911849 5.22068143]\n",
      " [4.86653115 4.7068944  5.05665371 ... 4.82064678 4.42379421 5.07489406]\n",
      " [4.87185288 4.84872337 5.13796275 ... 4.90211693 4.40278614 5.00933994]]\n",
      "nbops\n",
      "27\n",
      "prior\n",
      "18.70023769803553\n",
      "18.974285808750906\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "35 119.03342106286729\n",
      "simu\n",
      "[[4.84741615 4.68466595 4.90465747 ... 4.71145396 4.47047645 5.16324434]\n",
      " [4.8460847  4.84425734 4.8873892  ... 4.73781619 4.48453245 5.00438891]\n",
      " [4.90253981 4.73778158 5.06123702 ... 4.75984734 4.50148216 5.06369283]\n",
      " ...\n",
      " [4.83529434 4.77272827 5.02277081 ... 4.95705055 4.34107842 4.98966028]\n",
      " [4.87537872 4.75260444 5.16060121 ... 4.83189132 4.44783512 4.99544305]\n",
      " [4.8594113  4.87451632 5.08374261 ... 4.77629602 4.50154905 4.89255953]]\n",
      "nbops\n",
      "50\n",
      "prior\n",
      "18.90892247076048\n",
      "18.974285808750906\n",
      "C\n",
      "C\n",
      "36 116.97943444680551\n",
      "simu\n",
      "[[4.84741615 4.68466595 4.90465747 ... 4.71145396 4.47047645 5.16324434]\n",
      " [4.8460847  4.84425734 4.8873892  ... 4.73781619 4.48453245 5.00438891]\n",
      " [4.90253981 4.73778158 5.06123702 ... 4.75984734 4.50148216 5.06369283]\n",
      " ...\n",
      " [4.83529434 4.77272827 5.02277081 ... 4.95705055 4.34107842 4.98966028]\n",
      " [4.87537872 4.75260444 5.16060121 ... 4.83189132 4.44783512 4.99544305]\n",
      " [4.8594113  4.87451632 5.08374261 ... 4.77629602 4.50154905 4.89255953]]\n",
      "nbops\n",
      "41\n",
      "prior\n",
      "18.89774412514781\n",
      "18.974285808750906\n",
      "C\n",
      "C\n",
      "C\n",
      "37 113.06231715718292\n",
      "simu\n",
      "[[4.84741615 4.68466595 4.90465747 ... 4.71145396 4.47047645 5.16324434]\n",
      " [4.8460847  4.84425734 4.8873892  ... 4.73781619 4.48453245 5.00438891]\n",
      " [4.90253981 4.73778158 5.06123702 ... 4.75984734 4.50148216 5.06369283]\n",
      " ...\n",
      " [4.83529434 4.77272827 5.02277081 ... 4.95705055 4.34107842 4.98966028]\n",
      " [4.87537872 4.75260444 5.16060121 ... 4.83189132 4.44783512 4.99544305]\n",
      " [4.8594113  4.87451632 5.08374261 ... 4.77629602 4.50154905 4.89255953]]\n",
      "nbops\n",
      "34\n",
      "prior\n",
      "18.814286003743955\n",
      "18.974285808750906\n",
      "C\n",
      "C\n",
      "C\n",
      "38 110.79334407744958\n",
      "simu\n",
      "[[4.84741615 4.68466595 4.90465747 ... 4.71145396 4.47047645 5.16324434]\n",
      " [4.8460847  4.84425734 4.8873892  ... 4.73781619 4.48453245 5.00438891]\n",
      " [4.90253981 4.73778158 5.06123702 ... 4.75984734 4.50148216 5.06369283]\n",
      " ...\n",
      " [4.83529434 4.77272827 5.02277081 ... 4.95705055 4.34107842 4.98966028]\n",
      " [4.87537872 4.75260444 5.16060121 ... 4.83189132 4.44783512 4.99544305]\n",
      " [4.8594113  4.87451632 5.08374261 ... 4.77629602 4.50154905 4.89255953]]\n",
      "nbops\n",
      "25\n",
      "prior\n",
      "18.816821300469353\n",
      "19.00705707341004\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "39 110.29608564240593\n",
      "simu\n",
      "[[4.88145389 4.74490816 5.08430186 ... 4.73278039 4.50627617 5.1354492 ]\n",
      " [4.87537872 4.75260444 5.16060121 ... 4.83189132 4.44783512 4.99544305]\n",
      " [4.81342343 4.827975   5.02450137 ... 4.69780786 4.5115123  4.96334235]\n",
      " ...\n",
      " [4.87537872 4.75260444 5.16060121 ... 4.83189132 4.44783512 4.99544305]\n",
      " [4.86413016 4.89037967 5.07734338 ... 4.78155182 4.51756922 4.93748592]\n",
      " [4.83564112 4.83312041 4.96844265 ... 4.76013962 4.47435334 4.96006201]]\n",
      "nbops\n",
      "47\n",
      "prior\n",
      "18.96194821840708\n",
      "19.00705707341004\n",
      "C\n",
      "C\n",
      "C\n",
      "40 109.43107076572522\n",
      "simu\n",
      "[[4.88145389 4.74490816 5.08430186 ... 4.73278039 4.50627617 5.1354492 ]\n",
      " [4.87537872 4.75260444 5.16060121 ... 4.83189132 4.44783512 4.99544305]\n",
      " [4.83027179 4.83313167 5.00991495 ... 4.70330715 4.52713555 4.93909498]\n",
      " ...\n",
      " [4.87537872 4.75260444 5.16060121 ... 4.83189132 4.44783512 4.99544305]\n",
      " [4.86413016 4.89037967 5.07734338 ... 4.78155182 4.51756922 4.93748592]\n",
      " [4.83564112 4.83312041 4.96844265 ... 4.76013962 4.47435334 4.96006201]]\n",
      "nbops\n",
      "37\n",
      "prior\n",
      "18.980098159516402\n",
      "19.00705707341004\n",
      "C\n",
      "C\n",
      "C\n",
      "41 109.28278881654812\n",
      "simu\n",
      "[[4.88145389 4.74490816 5.08430186 ... 4.73278039 4.50627617 5.1354492 ]\n",
      " [4.87537872 4.75260444 5.16060121 ... 4.83189132 4.44783512 4.99544305]\n",
      " [4.83027179 4.83313167 5.00991495 ... 4.70330715 4.52713555 4.93909498]\n",
      " ...\n",
      " [4.87537872 4.75260444 5.16060121 ... 4.83189132 4.44783512 4.99544305]\n",
      " [4.86413016 4.89037967 5.07734338 ... 4.78155182 4.51756922 4.93748592]\n",
      " [4.83564112 4.83312041 4.96844265 ... 4.76013962 4.47435334 4.96006201]]\n",
      "nbops\n",
      "31\n",
      "prior\n",
      "18.87856075914465\n",
      "19.00705707341004\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "42 108.82901315691412\n",
      "simu\n",
      "[[4.88145389 4.74490816 5.08430186 ... 4.73278039 4.50627617 5.1354492 ]\n",
      " [4.82676092 4.77286994 4.95128409 ... 4.73513998 4.47141422 5.02802958]\n",
      " [4.81198444 4.73812345 5.03034639 ... 4.71459988 4.47914239 5.07019983]\n",
      " ...\n",
      " [4.87667317 4.81935488 5.1845096  ... 4.76508914 4.51444655 4.98638677]\n",
      " [4.83027179 4.83313167 5.00991495 ... 4.70330715 4.52713555 4.93909498]\n",
      " [4.86317833 4.76295903 5.09002883 ... 4.81957019 4.46074584 5.0116758 ]]\n",
      "nbops\n",
      "48\n",
      "prior\n",
      "18.922613481828204\n",
      "19.00705707341004\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "43 108.25093027287963\n",
      "simu\n",
      "[[4.88145389 4.74490816 5.08430186 ... 4.73278039 4.50627617 5.1354492 ]\n",
      " [4.82676092 4.77286994 4.95128409 ... 4.73513998 4.47141422 5.02802958]\n",
      " [4.81198444 4.73812345 5.03034639 ... 4.71459988 4.47914239 5.07019983]\n",
      " ...\n",
      " [4.87667317 4.81935488 5.1845096  ... 4.76508914 4.51444655 4.98638677]\n",
      " [4.83027179 4.83313167 5.00991495 ... 4.70330715 4.52713555 4.93909498]\n",
      " [4.86317833 4.76295903 5.09002883 ... 4.81957019 4.46074584 5.0116758 ]]\n",
      "nbops\n",
      "37\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "44 107.85712021826347\n",
      "simu\n",
      "[[4.88145389 4.74490816 5.08430186 ... 4.73278039 4.50627617 5.1354492 ]\n",
      " [4.82676092 4.77286994 4.95128409 ... 4.73513998 4.47141422 5.02802958]\n",
      " [4.81198444 4.73812345 5.03034639 ... 4.71459988 4.47914239 5.07019983]\n",
      " ...\n",
      " [4.87667317 4.81935488 5.1845096  ... 4.76508914 4.51444655 4.98638677]\n",
      " [4.83027179 4.83313167 5.00991495 ... 4.70330715 4.52713555 4.93909498]\n",
      " [4.86317833 4.76295903 5.09002883 ... 4.81957019 4.46074584 5.0116758 ]]\n",
      "nbops\n",
      "31\n",
      "C\n",
      "C\n",
      "45 106.86939490035107\n",
      "simu\n",
      "[[4.88145389 4.74490816 5.08430186 ... 4.73278039 4.50627617 5.1354492 ]\n",
      " [4.82676092 4.77286994 4.95128409 ... 4.73513998 4.47141422 5.02802958]\n",
      " [4.81198444 4.73812345 5.03034639 ... 4.71459988 4.47914239 5.07019983]\n",
      " ...\n",
      " [4.87667317 4.81935488 5.1845096  ... 4.76508914 4.51444655 4.98638677]\n",
      " [4.83027179 4.83313167 5.00991495 ... 4.70330715 4.52713555 4.93909498]\n",
      " [4.84302468 4.80489387 5.05641958 ... 4.76244877 4.50117617 4.95015374]]\n",
      "nbops\n",
      "25\n",
      "prior\n",
      "18.85748563032088\n",
      "18.97485556046265\n",
      "C\n",
      "C\n",
      "C\n",
      "46 106.29055178377703\n",
      "simu\n",
      "[[4.82676092 4.77286994 4.95128409 ... 4.73513998 4.47141422 5.02802958]\n",
      " [4.81892103 4.83212369 4.97803671 ... 4.71313305 4.5194812  4.94247163]\n",
      " [4.86554226 4.8736088  5.18793261 ... 4.76465806 4.53737566 4.92424399]\n",
      " ...\n",
      " [4.86554226 4.8736088  5.18793261 ... 4.76465806 4.53737566 4.92424399]\n",
      " [4.81892103 4.83212369 4.97803671 ... 4.71313305 4.5194812  4.94247163]\n",
      " [4.81435673 4.7735958  4.95859623 ... 4.6880899  4.50113033 5.01151666]]\n",
      "nbops\n",
      "48\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "47 105.89435183543341\n",
      "simu\n",
      "[[4.82676092 4.77286994 4.95128409 ... 4.73513998 4.47141422 5.02802958]\n",
      " [4.81892103 4.83212369 4.97803671 ... 4.71313305 4.5194812  4.94247163]\n",
      " [4.86554226 4.8736088  5.18793261 ... 4.76465806 4.53737566 4.92424399]\n",
      " ...\n",
      " [4.86554226 4.8736088  5.18793261 ... 4.76465806 4.53737566 4.92424399]\n",
      " [4.81892103 4.83212369 4.97803671 ... 4.71313305 4.5194812  4.94247163]\n",
      " [4.81435673 4.7735958  4.95859623 ... 4.6880899  4.50113033 5.01151666]]\n",
      "nbops\n",
      "35\n",
      "C\n",
      "C\n",
      "C\n",
      "48 105.3464239283327\n",
      "simu\n",
      "[[4.82676092 4.77286994 4.95128409 ... 4.73513998 4.47141422 5.02802958]\n",
      " [4.81892103 4.83212369 4.97803671 ... 4.71313305 4.5194812  4.94247163]\n",
      " [4.86554226 4.8736088  5.18793261 ... 4.76465806 4.53737566 4.92424399]\n",
      " ...\n",
      " [4.86554226 4.8736088  5.18793261 ... 4.76465806 4.53737566 4.92424399]\n",
      " [4.81892103 4.83212369 4.97803671 ... 4.71313305 4.5194812  4.94247163]\n",
      " [4.81435673 4.7735958  4.95859623 ... 4.6880899  4.50113033 5.01151666]]\n",
      "nbops\n",
      "29\n",
      "C\n",
      "C\n",
      "C\n",
      "49 105.15511854006118\n",
      "simu\n",
      "[[4.82676092 4.77286994 4.95128409 ... 4.73513998 4.47141422 5.02802958]\n",
      " [4.81892103 4.83212369 4.97803671 ... 4.71313305 4.5194812  4.94247163]\n",
      " [4.86554226 4.8736088  5.18793261 ... 4.76465806 4.53737566 4.92424399]\n",
      " ...\n",
      " [4.86554226 4.8736088  5.18793261 ... 4.76465806 4.53737566 4.92424399]\n",
      " [4.81892103 4.83212369 4.97803671 ... 4.71313305 4.5194812  4.94247163]\n",
      " [4.81435673 4.7735958  4.95859623 ... 4.6880899  4.50113033 5.01151666]]\n",
      "nbops\n",
      "25\n",
      "prior\n",
      "19.009885807674408\n",
      "19.02943402470073\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "50 104.99535375473448\n",
      "simu\n",
      "[[4.85391278 4.79828899 5.04331239 ... 4.71418068 4.51703875 5.04162739]\n",
      " [4.85092547 4.79032721 5.07842102 ... 4.74219913 4.51273769 4.99168225]\n",
      " [4.84302468 4.80489387 5.05641958 ... 4.76244877 4.50117617 4.95015374]\n",
      " ...\n",
      " [4.85092547 4.79032721 5.07842102 ... 4.74219913 4.51273769 4.99168225]\n",
      " [4.83027179 4.83313167 5.00991495 ... 4.70330715 4.52713555 4.93909498]\n",
      " [4.82978185 4.7784855  5.00591643 ... 4.69938349 4.50668616 5.03977932]]\n",
      "nbops\n",
      "49\n",
      "prior\n",
      "18.952927116315493\n",
      "19.02943402470073\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "51 104.54833840042193\n",
      "simu\n",
      "[[4.85391278 4.79828899 5.04331239 ... 4.71418068 4.51703875 5.04162739]\n",
      " [4.85092547 4.79032721 5.07842102 ... 4.74219913 4.51273769 4.99168225]\n",
      " [4.84903634 4.85225982 5.0796181  ... 4.7668795  4.5087579  4.94706449]\n",
      " ...\n",
      " [4.85092547 4.79032721 5.07842102 ... 4.74219913 4.51273769 4.99168225]\n",
      " [4.83027179 4.83313167 5.00991495 ... 4.70330715 4.52713555 4.93909498]\n",
      " [4.82978185 4.7784855  5.00591643 ... 4.69938349 4.50668616 5.03977932]]\n",
      "nbops\n",
      "33\n",
      "prior\n",
      "19.02958373030698\n",
      "19.02943402470073\n",
      "C\n",
      "C\n",
      "C\n",
      "52 103.98198493095987\n",
      "simu\n",
      "[[4.8399243  4.84612463 5.05824148 ... 4.67406675 4.54816376 5.01495953]\n",
      " [4.85092547 4.79032721 5.07842102 ... 4.74219913 4.51273769 4.99168225]\n",
      " [4.84903634 4.85225982 5.0796181  ... 4.7668795  4.5087579  4.94706449]\n",
      " ...\n",
      " [4.85092547 4.79032721 5.07842102 ... 4.74219913 4.51273769 4.99168225]\n",
      " [4.83027179 4.83313167 5.00991495 ... 4.70330715 4.52713555 4.93909498]\n",
      " [4.82033392 4.81414218 4.99328399 ... 4.66524074 4.5314626  5.01092276]]\n",
      "nbops\n",
      "28\n",
      "prior\n",
      "19.00569413254304\n",
      "19.019941367346476\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "53 103.62487332834596\n",
      "simu\n",
      "[[4.83165633 4.79484108 5.0281111  ... 4.71467653 4.5111292  4.9842588 ]\n",
      " [4.83646845 4.7782417  5.00367526 ... 4.70269452 4.50902633 5.03303139]\n",
      " [4.84512049 4.8448991  5.1141797  ... 4.74039334 4.52696823 4.97609268]\n",
      " ...\n",
      " [4.8337942  4.81802658 5.04552958 ... 4.72271479 4.51212113 4.98443254]\n",
      " [4.83238825 4.81430033 5.0574957  ... 4.72204013 4.5170917  4.97541351]\n",
      " [4.82425832 4.79994813 5.03635601 ... 4.677656   4.52874055 5.00777931]]\n",
      "nbops\n",
      "45\n",
      "prior\n",
      "19.016014441257507\n",
      "19.019941367346476\n",
      "C\n",
      "C\n",
      "54 103.51794676338321\n",
      "simu\n",
      "[[4.83165633 4.79484108 5.0281111  ... 4.71467653 4.5111292  4.9842588 ]\n",
      " [4.83646845 4.7782417  5.00367526 ... 4.70269452 4.50902633 5.03303139]\n",
      " [4.84512049 4.8448991  5.1141797  ... 4.74039334 4.52696823 4.97609268]\n",
      " ...\n",
      " [4.8337942  4.81802658 5.04552958 ... 4.72271479 4.51212113 4.98443254]\n",
      " [4.83238825 4.81430033 5.0574957  ... 4.72204013 4.5170917  4.97541351]\n",
      " [4.82425832 4.79994813 5.03635601 ... 4.677656   4.52874055 5.00777931]]\n",
      "nbops\n",
      "39\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "55 103.35508279894984\n",
      "simu\n",
      "[[4.83165633 4.79484108 5.0281111  ... 4.71467653 4.5111292  4.9842588 ]\n",
      " [4.83646845 4.7782417  5.00367526 ... 4.70269452 4.50902633 5.03303139]\n",
      " [4.84512049 4.8448991  5.1141797  ... 4.74039334 4.52696823 4.97609268]\n",
      " ...\n",
      " [4.8337942  4.81802658 5.04552958 ... 4.72271479 4.51212113 4.98443254]\n",
      " [4.83238825 4.81430033 5.0574957  ... 4.72204013 4.5170917  4.97541351]\n",
      " [4.82425832 4.79994813 5.03635601 ... 4.677656   4.52874055 5.00777931]]\n",
      "nbops\n",
      "28\n",
      "C\n",
      "C\n",
      "56 103.21804160650382\n",
      "simu\n",
      "[[4.83165633 4.79484108 5.0281111  ... 4.71467653 4.5111292  4.9842588 ]\n",
      " [4.83646845 4.7782417  5.00367526 ... 4.70269452 4.50902633 5.03303139]\n",
      " [4.84512049 4.8448991  5.1141797  ... 4.74039334 4.52696823 4.97609268]\n",
      " ...\n",
      " [4.8337942  4.81802658 5.04552958 ... 4.72271479 4.51212113 4.98443254]\n",
      " [4.83238825 4.81430033 5.0574957  ... 4.72204013 4.5170917  4.97541351]\n",
      " [4.82425832 4.79994813 5.03635601 ... 4.677656   4.52874055 5.00777931]]\n",
      "nbops\n",
      "25\n",
      "prior\n",
      "19.022707457715043\n",
      "19.02958373030698\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "57 103.14053168181562\n",
      "simu\n",
      "[[4.8399243  4.84612463 5.05824148 ... 4.67406675 4.54816376 5.01495953]\n",
      " [4.8501032  4.86651856 5.07574071 ... 4.73731331 4.51803789 4.99884348]\n",
      " [4.84412581 4.78743497 5.04310402 ... 4.7593102  4.49072764 4.98751812]\n",
      " ...\n",
      " [4.83960639 4.873416   5.07262296 ... 4.63966285 4.57319815 5.04114127]\n",
      " [4.84128717 4.79067157 5.04660001 ... 4.72466063 4.51770779 4.96712624]\n",
      " [4.8337942  4.81802658 5.04552958 ... 4.72271479 4.51212113 4.98443254]]\n",
      "nbops\n",
      "48\n",
      "prior\n",
      "18.998568079327757\n",
      "19.02958373030698\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "58 103.03393057233811\n",
      "simu\n",
      "[[4.8399243  4.84612463 5.05824148 ... 4.67406675 4.54816376 5.01495953]\n",
      " [4.8501032  4.86651856 5.07574071 ... 4.73731331 4.51803789 4.99884348]\n",
      " [4.84412581 4.78743497 5.04310402 ... 4.7593102  4.49072764 4.98751812]\n",
      " ...\n",
      " [4.83960639 4.873416   5.07262296 ... 4.63966285 4.57319815 5.04114127]\n",
      " [4.84128717 4.79067157 5.04660001 ... 4.72466063 4.51770779 4.96712624]\n",
      " [4.83601078 4.83878689 5.05620187 ... 4.70130245 4.53010923 4.99181157]]\n",
      "nbops\n",
      "37\n",
      "prior\n",
      "19.00948025857153\n",
      "19.02958373030698\n",
      "C\n",
      "C\n",
      "C\n",
      "59 102.94714829462978\n",
      "simu\n",
      "[[4.8399243  4.84612463 5.05824148 ... 4.67406675 4.54816376 5.01495953]\n",
      " [4.8501032  4.86651856 5.07574071 ... 4.73731331 4.51803789 4.99884348]\n",
      " [4.84412581 4.78743497 5.04310402 ... 4.7593102  4.49072764 4.98751812]\n",
      " ...\n",
      " [4.83705731 4.88703583 5.0746099  ... 4.66561202 4.55875402 5.01422229]\n",
      " [4.84128717 4.79067157 5.04660001 ... 4.72466063 4.51770779 4.96712624]\n",
      " [4.83601078 4.83878689 5.05620187 ... 4.70130245 4.53010923 4.99181157]]\n",
      "nbops\n",
      "34\n",
      "prior\n",
      "19.012919060141243\n",
      "19.02958373030698\n",
      "C\n",
      "60 102.72597467712342\n",
      "simu\n",
      "[[4.8399243  4.84612463 5.05824148 ... 4.67406675 4.54816376 5.01495953]\n",
      " [4.8501032  4.86651856 5.07574071 ... 4.73731331 4.51803789 4.99884348]\n",
      " [4.84412581 4.78743497 5.04310402 ... 4.7593102  4.49072764 4.98751812]\n",
      " ...\n",
      " [4.83705731 4.88703583 5.0746099  ... 4.66561202 4.55875402 5.01422229]\n",
      " [4.84128717 4.79067157 5.04660001 ... 4.72466063 4.51770779 4.96712624]\n",
      " [4.83601078 4.83878689 5.05620187 ... 4.70130245 4.53010923 4.99181157]]\n",
      "nbops\n",
      "28\n",
      "prior\n",
      "19.051065697518915\n",
      "19.046031380653957\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "61 102.3295476395501\n",
      "simu\n",
      "[[4.85398681 4.83122577 5.05781943 ... 4.69260927 4.5409576  5.0441847 ]\n",
      " [4.85194775 4.84155376 5.07778253 ... 4.69570892 4.54327686 5.03468127]\n",
      " [4.83025747 4.83328534 5.02629529 ... 4.71497012 4.51218547 4.98893017]\n",
      " ...\n",
      " [4.86503582 4.88021025 5.12977351 ... 4.74231859 4.53422841 5.00355319]\n",
      " [4.85168381 4.88275132 5.08898382 ... 4.67887573 4.55529988 5.05226312]\n",
      " [4.82467014 4.84234294 5.04589783 ... 4.65614372 4.54777276 5.02934133]]\n",
      "nbops\n",
      "46\n",
      "prior\n",
      "19.052723081399847\n",
      "19.051065697518915\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "62 102.24617464258404\n",
      "simu\n",
      "[[4.85001843 4.84789084 5.06850805 ... 4.69854082 4.54079861 5.02382644]\n",
      " [4.84687787 4.87008328 5.07761994 ... 4.68016279 4.55284474 5.04075272]\n",
      " [4.83025747 4.83328534 5.02629529 ... 4.71497012 4.51218547 4.98893017]\n",
      " ...\n",
      " [4.86503582 4.88021025 5.12977351 ... 4.74231859 4.53422841 5.00355319]\n",
      " [4.84823824 4.89799221 5.1139294  ... 4.68533424 4.55812262 5.03229628]\n",
      " [4.82467014 4.84234294 5.04589783 ... 4.65614372 4.54777276 5.02934133]]\n",
      "nbops\n",
      "40\n",
      "prior\n",
      "19.00654532922559\n",
      "19.052723081399847\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "63 102.20108286539119\n",
      "simu\n",
      "[[4.85001843 4.84789084 5.06850805 ... 4.69854082 4.54079861 5.02382644]\n",
      " [4.84687787 4.87008328 5.07761994 ... 4.68016279 4.55284474 5.04075272]\n",
      " [4.83025747 4.83328534 5.02629529 ... 4.71497012 4.51218547 4.98893017]\n",
      " ...\n",
      " [4.86503582 4.88021025 5.12977351 ... 4.74231859 4.53422841 5.00355319]\n",
      " [4.84823824 4.89799221 5.1139294  ... 4.68533424 4.55812262 5.03229628]\n",
      " [4.83380298 4.83204437 5.05535266 ... 4.68657812 4.53456203 5.0210163 ]]\n",
      "nbops\n",
      "33\n",
      "prior\n",
      "19.05053651521972\n",
      "19.052723081399847\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "64 101.87391984545758\n",
      "simu\n",
      "[[4.85001843 4.84789084 5.06850805 ... 4.69854082 4.54079861 5.02382644]\n",
      " [4.84687787 4.87008328 5.07761994 ... 4.68016279 4.55284474 5.04075272]\n",
      " [4.83025747 4.83328534 5.02629529 ... 4.71497012 4.51218547 4.98893017]\n",
      " ...\n",
      " [4.86503582 4.88021025 5.12977351 ... 4.74231859 4.53422841 5.00355319]\n",
      " [4.84823824 4.89799221 5.1139294  ... 4.68533424 4.55812262 5.03229628]\n",
      " [4.83380298 4.83204437 5.05535266 ... 4.68657812 4.53456203 5.0210163 ]]\n",
      "nbops\n",
      "27\n",
      "prior\n",
      "19.050869417094766\n",
      "19.03401337560768\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "65 101.73232796102698\n",
      "simu\n",
      "[[4.84880481 4.93861743 5.14627132 ... 4.71119108 4.55384801 5.03449975]\n",
      " [4.84823824 4.89799221 5.1139294  ... 4.68533424 4.55812262 5.03229628]\n",
      " [4.85051067 4.88206614 5.09171619 ... 4.70387302 4.54503294 5.01451562]\n",
      " ...\n",
      " [4.83380298 4.83204437 5.05535266 ... 4.68657812 4.53456203 5.0210163 ]\n",
      " [4.84775442 4.88285639 5.10111103 ... 4.71369736 4.54036619 5.00276696]\n",
      " [4.83886259 4.84437361 5.07432727 ... 4.70534128 4.5285574  5.01662303]]\n",
      "nbops\n",
      "47\n",
      "prior\n",
      "19.03915903339766\n",
      "19.050869417094766\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "66 101.60417432627276\n",
      "simu\n",
      "[[4.84880481 4.93861743 5.14627132 ... 4.71119108 4.55384801 5.03449975]\n",
      " [4.84823824 4.89799221 5.1139294  ... 4.68533424 4.55812262 5.03229628]\n",
      " [4.85051067 4.88206614 5.09171619 ... 4.70387302 4.54503294 5.01451562]\n",
      " ...\n",
      " [4.83380298 4.83204437 5.05535266 ... 4.68657812 4.53456203 5.0210163 ]\n",
      " [4.84775442 4.88285639 5.10111103 ... 4.71369736 4.54036619 5.00276696]\n",
      " [4.83886259 4.84437361 5.07432727 ... 4.70534128 4.5285574  5.01662303]]\n",
      "nbops\n",
      "37\n",
      "prior\n",
      "19.066603480764396\n",
      "19.050869417094766\n",
      "C\n",
      "C\n",
      "67 101.52185654066659\n",
      "simu\n",
      "[[4.84880481 4.93861743 5.14627132 ... 4.71119108 4.55384801 5.03449975]\n",
      " [4.84823824 4.89799221 5.1139294  ... 4.68533424 4.55812262 5.03229628]\n",
      " [4.85051067 4.88206614 5.09171619 ... 4.70387302 4.54503294 5.01451562]\n",
      " ...\n",
      " [4.83380298 4.83204437 5.05535266 ... 4.68657812 4.53456203 5.0210163 ]\n",
      " [4.84775442 4.88285639 5.10111103 ... 4.71369736 4.54036619 5.00276696]\n",
      " [4.83886259 4.84437361 5.07432727 ... 4.70534128 4.5285574  5.01662303]]\n",
      "nbops\n",
      "30\n",
      "prior\n",
      "19.024076026683133\n",
      "19.04338783319947\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "68 101.33939256851082\n",
      "simu\n",
      "[[4.84382371 4.92420138 5.12209659 ... 4.74329732 4.52833462 4.98507501]\n",
      " [4.86220925 4.92686433 5.16422011 ... 4.7124355  4.56128622 5.03489738]\n",
      " [4.86220925 4.92686433 5.16422011 ... 4.7124355  4.56128622 5.03489738]\n",
      " ...\n",
      " [4.83717636 4.88845106 5.09427588 ... 4.73773101 4.51566241 5.01666408]\n",
      " [4.84823824 4.89799221 5.1139294  ... 4.68533424 4.55812262 5.03229628]\n",
      " [4.83104152 4.87850296 5.05142836 ... 4.68541578 4.53804575 5.01985578]]\n",
      "nbops\n",
      "49\n",
      "prior\n",
      "19.017512534573157\n",
      "19.024076026683133\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "69 101.29409178982743\n",
      "simu\n",
      "[[4.84382371 4.92420138 5.12209659 ... 4.74329732 4.52833462 4.98507501]\n",
      " [4.86220925 4.92686433 5.16422011 ... 4.7124355  4.56128622 5.03489738]\n",
      " [4.86220925 4.92686433 5.16422011 ... 4.7124355  4.56128622 5.03489738]\n",
      " ...\n",
      " [4.83717636 4.88845106 5.09427588 ... 4.73773101 4.51566241 5.01666408]\n",
      " [4.84823824 4.89799221 5.1139294  ... 4.68533424 4.55812262 5.03229628]\n",
      " [4.83104152 4.87850296 5.05142836 ... 4.68541578 4.53804575 5.01985578]]\n",
      "nbops\n",
      "29\n",
      "prior\n",
      "18.9956142602749\n",
      "19.024076026683133\n",
      "C\n",
      "C\n",
      "70 101.08903703667725\n",
      "simu\n",
      "[[4.84382371 4.92420138 5.12209659 ... 4.74329732 4.52833462 4.98507501]\n",
      " [4.86220925 4.92686433 5.16422011 ... 4.7124355  4.56128622 5.03489738]\n",
      " [4.86220925 4.92686433 5.16422011 ... 4.7124355  4.56128622 5.03489738]\n",
      " ...\n",
      " [4.83717636 4.88845106 5.09427588 ... 4.73773101 4.51566241 5.01666408]\n",
      " [4.84823824 4.89799221 5.1139294  ... 4.68533424 4.55812262 5.03229628]\n",
      " [4.83104152 4.87850296 5.05142836 ... 4.68541578 4.53804575 5.01985578]]\n",
      "nbops\n",
      "26\n",
      "prior\n",
      "19.044210041198202\n",
      "19.04187749179818\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "71 100.87199475886297\n",
      "simu\n",
      "[[4.83717636 4.88845106 5.09427588 ... 4.73773101 4.51566241 5.01666408]\n",
      " [4.84435988 4.93032698 5.12650108 ... 4.74253865 4.5245475  5.0225797 ]\n",
      " [4.83932564 4.9157408  5.10068486 ... 4.72038384 4.52776771 5.05069378]\n",
      " ...\n",
      " [4.84317194 4.90381329 5.12258146 ... 4.76003173 4.50703166 5.0356534 ]\n",
      " [4.83717636 4.88845106 5.09427588 ... 4.73773101 4.51566241 5.01666408]\n",
      " [4.8399012  4.92509139 5.10847094 ... 4.73863672 4.5163016  5.06127912]]\n",
      "nbops\n",
      "46\n",
      "prior\n",
      "19.06379367320552\n",
      "19.04187749179818\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "72 100.66806886587244\n",
      "simu\n",
      "[[4.83717636 4.88845106 5.09427588 ... 4.73773101 4.51566241 5.01666408]\n",
      " [4.84435988 4.93032698 5.12650108 ... 4.74253865 4.5245475  5.0225797 ]\n",
      " [4.83932564 4.9157408  5.10068486 ... 4.72038384 4.52776771 5.05069378]\n",
      " ...\n",
      " [4.84317194 4.90381329 5.12258146 ... 4.76003173 4.50703166 5.0356534 ]\n",
      " [4.83891071 4.90807601 5.09875768 ... 4.70681228 4.52971272 5.09804395]\n",
      " [4.8399012  4.92509139 5.10847094 ... 4.73863672 4.5163016  5.06127912]]\n",
      "nbops\n",
      "32\n",
      "C\n",
      "73 100.6424893636999\n",
      "simu\n",
      "[[4.83717636 4.88845106 5.09427588 ... 4.73773101 4.51566241 5.01666408]\n",
      " [4.84435988 4.93032698 5.12650108 ... 4.74253865 4.5245475  5.0225797 ]\n",
      " [4.83932564 4.9157408  5.10068486 ... 4.72038384 4.52776771 5.05069378]\n",
      " ...\n",
      " [4.84317194 4.90381329 5.12258146 ... 4.76003173 4.50703166 5.0356534 ]\n",
      " [4.83891071 4.90807601 5.09875768 ... 4.70681228 4.52971272 5.09804395]\n",
      " [4.8399012  4.92509139 5.10847094 ... 4.73863672 4.5163016  5.06127912]]\n",
      "nbops\n",
      "30\n",
      "C\n",
      "C\n",
      "C\n",
      "74 100.5893099119629\n",
      "simu\n",
      "[[4.83717636 4.88845106 5.09427588 ... 4.73773101 4.51566241 5.01666408]\n",
      " [4.84435988 4.93032698 5.12650108 ... 4.74253865 4.5245475  5.0225797 ]\n",
      " [4.83932564 4.9157408  5.10068486 ... 4.72038384 4.52776771 5.05069378]\n",
      " ...\n",
      " [4.84317194 4.90381329 5.12258146 ... 4.76003173 4.50703166 5.0356534 ]\n",
      " [4.83891071 4.90807601 5.09875768 ... 4.70681228 4.52971272 5.09804395]\n",
      " [4.8399012  4.92509139 5.10847094 ... 4.73863672 4.5163016  5.06127912]]\n",
      "nbops\n",
      "27\n",
      "prior\n",
      "19.044801128653194\n",
      "19.058518507536313\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "75 100.42567786647416\n",
      "simu\n",
      "[[4.84522385 4.93604249 5.14694835 ... 4.72172049 4.53832888 5.06178588]\n",
      " [4.835123   4.90475234 5.08335302 ... 4.75144013 4.49879303 5.04439147]\n",
      " [4.84047517 4.91665296 5.10791761 ... 4.75848784 4.50727121 5.01574341]\n",
      " ...\n",
      " [4.8366929  4.92816263 5.10535339 ... 4.73143677 4.51662988 5.06877719]\n",
      " [4.83891071 4.90807601 5.09875768 ... 4.70681228 4.52971272 5.09804395]\n",
      " [4.83548807 4.91733127 5.09853587 ... 4.72878027 4.5209685  5.03623432]]\n",
      "nbops\n",
      "50\n",
      "prior\n",
      "19.048658296217738\n",
      "19.044801128653194\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "76 100.25449469477789\n",
      "simu\n",
      "[[4.84522385 4.93604249 5.14694835 ... 4.72172049 4.53832888 5.06178588]\n",
      " [4.835123   4.90475234 5.08335302 ... 4.75144013 4.49879303 5.04439147]\n",
      " [4.84047517 4.91665296 5.10791761 ... 4.75848784 4.50727121 5.01574341]\n",
      " ...\n",
      " [4.8366929  4.92816263 5.10535339 ... 4.73143677 4.51662988 5.06877719]\n",
      " [4.83891071 4.90807601 5.09875768 ... 4.70681228 4.52971272 5.09804395]\n",
      " [4.83548807 4.91733127 5.09853587 ... 4.72878027 4.5209685  5.03623432]]\n",
      "nbops\n",
      "34\n",
      "prior\n",
      "19.03474771677031\n",
      "19.044801128653194\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "77 100.21228182985081\n",
      "simu\n",
      "[[4.83853585 4.92740848 5.12510801 ... 4.74532348 4.51330626 5.05964482]\n",
      " [4.835123   4.90475234 5.08335302 ... 4.75144013 4.49879303 5.04439147]\n",
      " [4.84047517 4.91665296 5.10791761 ... 4.75848784 4.50727121 5.01574341]\n",
      " ...\n",
      " [4.8366929  4.92816263 5.10535339 ... 4.73143677 4.51662988 5.06877719]\n",
      " [4.83891071 4.90807601 5.09875768 ... 4.70681228 4.52971272 5.09804395]\n",
      " [4.83548807 4.91733127 5.09853587 ... 4.72878027 4.5209685  5.03623432]]\n",
      "nbops\n",
      "31\n",
      "prior\n",
      "19.02037429347067\n",
      "19.03474771677031\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "78 100.069477616519\n",
      "simu\n",
      "[[4.83853585 4.92740848 5.12510801 ... 4.74532348 4.51330626 5.05964482]\n",
      " [4.835123   4.90475234 5.08335302 ... 4.75144013 4.49879303 5.04439147]\n",
      " [4.84047517 4.91665296 5.10791761 ... 4.75848784 4.50727121 5.01574341]\n",
      " ...\n",
      " [4.8366929  4.92816263 5.10535339 ... 4.73143677 4.51662988 5.06877719]\n",
      " [4.83891071 4.90807601 5.09875768 ... 4.70681228 4.52971272 5.09804395]\n",
      " [4.83548807 4.91733127 5.09853587 ... 4.72878027 4.5209685  5.03623432]]\n",
      "nbops\n",
      "26\n",
      "prior\n",
      "19.039261021287533\n",
      "19.0130130545071\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "79 100.01997631636468\n",
      "simu\n",
      "[[4.83498632 4.93692309 5.0852186  ... 4.76833739 4.48889385 5.04147786]\n",
      " [4.83818073 4.92166103 5.11149295 ... 4.74942439 4.50475747 5.06875579]\n",
      " [4.83427664 4.90989737 5.08403399 ... 4.73854057 4.50769648 5.05712491]\n",
      " ...\n",
      " [4.83463521 4.95394355 5.09463259 ... 4.74525751 4.50854378 5.04847507]\n",
      " [4.83112822 4.92254721 5.07727994 ... 4.73697794 4.50385658 5.06885643]\n",
      " [4.83105535 4.92015353 5.09829163 ... 4.72477959 4.51538741 5.07823551]]\n",
      "nbops\n",
      "46\n",
      "prior\n",
      "19.028841188926386\n",
      "19.0130130545071\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "80 99.97075592366103\n",
      "simu\n",
      "[[4.83498632 4.93692309 5.0852186  ... 4.76833739 4.48889385 5.04147786]\n",
      " [4.83818073 4.92166103 5.11149295 ... 4.74942439 4.50475747 5.06875579]\n",
      " [4.82791281 4.91211004 5.07506878 ... 4.74102899 4.50063136 5.05937308]\n",
      " ...\n",
      " [4.83463521 4.95394355 5.09463259 ... 4.74525751 4.50854378 5.04847507]\n",
      " [4.83112822 4.92254721 5.07727994 ... 4.73697794 4.50385658 5.06885643]\n",
      " [4.83105535 4.92015353 5.09829163 ... 4.72477959 4.51538741 5.07823551]]\n",
      "nbops\n",
      "42\n",
      "prior\n",
      "18.987685789074405\n",
      "19.0130130545071\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "81 99.90007254591896\n",
      "simu\n",
      "[[4.83498632 4.93692309 5.0852186  ... 4.76833739 4.48889385 5.04147786]\n",
      " [4.83818073 4.92166103 5.11149295 ... 4.74942439 4.50475747 5.06875579]\n",
      " [4.82791281 4.91211004 5.07506878 ... 4.74102899 4.50063136 5.05937308]\n",
      " ...\n",
      " [4.8335474  4.95173646 5.1052963  ... 4.73315866 4.51608262 5.05448203]\n",
      " [4.83112822 4.92254721 5.07727994 ... 4.73697794 4.50385658 5.06885643]\n",
      " [4.83105535 4.92015353 5.09829163 ... 4.72477959 4.51538741 5.07823551]]\n",
      "nbops\n",
      "34\n",
      "prior\n",
      "19.02189421683255\n",
      "19.0130130545071\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "82 99.81655344324469\n",
      "simu\n",
      "[[4.83498632 4.93692309 5.0852186  ... 4.76833739 4.48889385 5.04147786]\n",
      " [4.83818073 4.92166103 5.11149295 ... 4.74942439 4.50475747 5.06875579]\n",
      " [4.82791281 4.91211004 5.07506878 ... 4.74102899 4.50063136 5.05937308]\n",
      " ...\n",
      " [4.8335474  4.95173646 5.1052963  ... 4.73315866 4.51608262 5.05448203]\n",
      " [4.83441442 4.92755526 5.0972014  ... 4.75138885 4.50240395 5.04836763]\n",
      " [4.83105535 4.92015353 5.09829163 ... 4.72477959 4.51538741 5.07823551]]\n",
      "nbops\n",
      "28\n",
      "prior\n",
      "18.98605189230179\n",
      "19.0130130545071\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "83 99.77275354622029\n",
      "simu\n",
      "[[4.83498632 4.93692309 5.0852186  ... 4.76833739 4.48889385 5.04147786]\n",
      " [4.83463521 4.95394355 5.09463259 ... 4.74525751 4.50854378 5.04847507]\n",
      " [4.83496113 4.93083341 5.09765492 ... 4.74712071 4.5054328  5.04951548]\n",
      " ...\n",
      " [4.83463521 4.95394355 5.09463259 ... 4.74525751 4.50854378 5.04847507]\n",
      " [4.83234357 4.93890538 5.09662573 ... 4.74230992 4.506382   5.05737608]\n",
      " [4.83287709 4.94556995 5.08761046 ... 4.76259276 4.49216527 5.05032317]]\n",
      "nbops\n",
      "50\n",
      "prior\n",
      "19.0020144473608\n",
      "19.0130130545071\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "84 99.75034796941043\n",
      "simu\n",
      "[[4.83498632 4.93692309 5.0852186  ... 4.76833739 4.48889385 5.04147786]\n",
      " [4.83463521 4.95394355 5.09463259 ... 4.74525751 4.50854378 5.04847507]\n",
      " [4.83496113 4.93083341 5.09765492 ... 4.74712071 4.5054328  5.04951548]\n",
      " ...\n",
      " [4.83463521 4.95394355 5.09463259 ... 4.74525751 4.50854378 5.04847507]\n",
      " [4.83234357 4.93890538 5.09662573 ... 4.74230992 4.506382   5.05737608]\n",
      " [4.83287709 4.94556995 5.08761046 ... 4.76259276 4.49216527 5.05032317]]\n",
      "nbops\n",
      "36\n",
      "C\n",
      "C\n",
      "C\n",
      "85 99.72659043184225\n",
      "simu\n",
      "[[4.83498632 4.93692309 5.0852186  ... 4.76833739 4.48889385 5.04147786]\n",
      " [4.83463521 4.95394355 5.09463259 ... 4.74525751 4.50854378 5.04847507]\n",
      " [4.83496113 4.93083341 5.09765492 ... 4.74712071 4.5054328  5.04951548]\n",
      " ...\n",
      " [4.83463521 4.95394355 5.09463259 ... 4.74525751 4.50854378 5.04847507]\n",
      " [4.83234357 4.93890538 5.09662573 ... 4.74230992 4.506382   5.05737608]\n",
      " [4.83287709 4.94556995 5.08761046 ... 4.76259276 4.49216527 5.05032317]]\n",
      "nbops\n",
      "32\n",
      "C\n",
      "C\n",
      "C\n",
      "86 99.71233870584362\n",
      "simu\n",
      "[[4.83498632 4.93692309 5.0852186  ... 4.76833739 4.48889385 5.04147786]\n",
      " [4.83463521 4.95394355 5.09463259 ... 4.74525751 4.50854378 5.04847507]\n",
      " [4.83496113 4.93083341 5.09765492 ... 4.74712071 4.5054328  5.04951548]\n",
      " ...\n",
      " [4.83463521 4.95394355 5.09463259 ... 4.74525751 4.50854378 5.04847507]\n",
      " [4.83234357 4.93890538 5.09662573 ... 4.74230992 4.506382   5.05737608]\n",
      " [4.83315258 4.95207282 5.10212873 ... 4.76751995 4.49223423 5.04211832]]\n",
      "nbops\n",
      "26\n",
      "prior\n",
      "19.036257620154718\n",
      "19.029796008852355\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "87 99.69682184109251\n",
      "simu\n",
      "[[4.83233139 4.93262483 5.09780229 ... 4.74088004 4.50658806 5.0551904 ]\n",
      " [4.83287709 4.94556995 5.08761046 ... 4.76259276 4.49216527 5.05032317]\n",
      " [4.82717679 4.94536577 5.0809766  ... 4.75596472 4.4967676  5.02131528]\n",
      " ...\n",
      " [4.83234357 4.93890538 5.09662573 ... 4.74230992 4.506382   5.05737608]\n",
      " [4.83109172 4.95300134 5.0855853  ... 4.75606119 4.49647014 5.0494296 ]\n",
      " [4.83312411 4.9430664  5.10888854 ... 4.73414825 4.51513836 5.06805656]]\n",
      "nbops\n",
      "48\n",
      "prior\n",
      "19.02350526674979\n",
      "19.029796008852355\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "88 99.65647612446612\n",
      "simu\n",
      "[[4.83233139 4.93262483 5.09780229 ... 4.74088004 4.50658806 5.0551904 ]\n",
      " [4.8320638  4.94561677 5.09462646 ... 4.76960567 4.49063662 5.03389644]\n",
      " [4.82717679 4.94536577 5.0809766  ... 4.75596472 4.4967676  5.02131528]\n",
      " ...\n",
      " [4.83189967 4.94170522 5.09515342 ... 4.74301968 4.50399403 5.06576552]\n",
      " [4.83109172 4.95300134 5.0855853  ... 4.75606119 4.49647014 5.0494296 ]\n",
      " [4.83064625 4.94986759 5.09943547 ... 4.73608593 4.51121072 5.05970162]]\n",
      "nbops\n",
      "39\n",
      "prior\n",
      "19.01499199125079\n",
      "19.029796008852355\n",
      "C\n",
      "89 99.6223838868514\n",
      "simu\n",
      "[[4.83233139 4.93262483 5.09780229 ... 4.74088004 4.50658806 5.0551904 ]\n",
      " [4.8320638  4.94561677 5.09462646 ... 4.76960567 4.49063662 5.03389644]\n",
      " [4.82717679 4.94536577 5.0809766  ... 4.75596472 4.4967676  5.02131528]\n",
      " ...\n",
      " [4.83189967 4.94170522 5.09515342 ... 4.74301968 4.50399403 5.06576552]\n",
      " [4.83150559 4.95766738 5.10535767 ... 4.74321014 4.5120059  5.04764391]\n",
      " [4.83064625 4.94986759 5.09943547 ... 4.73608593 4.51121072 5.05970162]]\n",
      "nbops\n",
      "34\n",
      "C\n",
      "C\n",
      "C\n",
      "90 99.60627562439666\n",
      "simu\n",
      "[[4.83233139 4.93262483 5.09780229 ... 4.74088004 4.50658806 5.0551904 ]\n",
      " [4.8320638  4.94561677 5.09462646 ... 4.76960567 4.49063662 5.03389644]\n",
      " [4.82717679 4.94536577 5.0809766  ... 4.75596472 4.4967676  5.02131528]\n",
      " ...\n",
      " [4.83210986 4.93522071 5.09555699 ... 4.75075685 4.49910687 5.05944427]\n",
      " [4.83150559 4.95766738 5.10535767 ... 4.74321014 4.5120059  5.04764391]\n",
      " [4.83064625 4.94986759 5.09943547 ... 4.73608593 4.51121072 5.05970162]]\n",
      "nbops\n",
      "28\n",
      "prior\n",
      "19.015821089704588\n",
      "19.010407101994026\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "91 99.58383008348177\n",
      "simu\n",
      "[[4.83471776 4.93941943 5.09512473 ... 4.75845692 4.49678483 5.05604569]\n",
      " [4.83452978 4.92850698 5.0995057  ... 4.75889265 4.49555488 5.05587741]\n",
      " [4.83234357 4.93890538 5.09662573 ... 4.74230992 4.506382   5.05737608]\n",
      " ...\n",
      " [4.83064625 4.94986759 5.09943547 ... 4.73608593 4.51121072 5.05970162]\n",
      " [4.83265509 4.94283781 5.10296656 ... 4.73793798 4.51147117 5.05947429]\n",
      " [4.83150559 4.95766738 5.10535767 ... 4.74321014 4.5120059  5.04764391]]\n",
      "nbops\n",
      "44\n",
      "prior\n",
      "18.998013832474744\n",
      "19.015821089704588\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "92 99.57553412439563\n",
      "simu\n",
      "[[4.83471776 4.93941943 5.09512473 ... 4.75845692 4.49678483 5.05604569]\n",
      " [4.83452978 4.92850698 5.0995057  ... 4.75889265 4.49555488 5.05587741]\n",
      " [4.83246473 4.94814466 5.10101918 ... 4.75325091 4.50161721 5.04613039]\n",
      " ...\n",
      " [4.83064625 4.94986759 5.09943547 ... 4.73608593 4.51121072 5.05970162]\n",
      " [4.83382646 4.95340712 5.1076946  ... 4.7373055  4.51606198 5.05576749]\n",
      " [4.83150559 4.95766738 5.10535767 ... 4.74321014 4.5120059  5.04764391]]\n",
      "nbops\n",
      "40\n",
      "prior\n",
      "19.01206164448031\n",
      "19.015821089704588\n",
      "C\n",
      "93 99.55125574629014\n",
      "simu\n",
      "[[4.83471776 4.93941943 5.09512473 ... 4.75845692 4.49678483 5.05604569]\n",
      " [4.83452978 4.92850698 5.0995057  ... 4.75889265 4.49555488 5.05587741]\n",
      " [4.83246473 4.94814466 5.10101918 ... 4.75325091 4.50161721 5.04613039]\n",
      " ...\n",
      " [4.83064625 4.94986759 5.09943547 ... 4.73608593 4.51121072 5.05970162]\n",
      " [4.83382646 4.95340712 5.1076946  ... 4.7373055  4.51606198 5.05576749]\n",
      " [4.83277156 4.94732574 5.09701366 ... 4.76236578 4.49631552 5.04050672]]\n",
      "nbops\n",
      "34\n",
      "prior\n",
      "19.008922811479845\n",
      "19.010163604254284\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "94 99.54140720181843\n",
      "simu\n",
      "[[4.83175595 4.94461061 5.09315521 ... 4.75456855 4.49743488 5.05380293]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " ...\n",
      " [4.83210986 4.93522071 5.09555699 ... 4.75075685 4.49910687 5.05944427]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " [4.83380007 4.94638146 5.09969681 ... 4.75349132 4.49874171 5.06226425]]\n",
      "nbops\n",
      "48\n",
      "prior\n",
      "19.01483067171948\n",
      "19.010163604254284\n",
      "C\n",
      "C\n",
      "95 99.53530806265826\n",
      "simu\n",
      "[[4.83175595 4.94461061 5.09315521 ... 4.75456855 4.49743488 5.05380293]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " ...\n",
      " [4.83210986 4.93522071 5.09555699 ... 4.75075685 4.49910687 5.05944427]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " [4.83380007 4.94638146 5.09969681 ... 4.75349132 4.49874171 5.06226425]]\n",
      "nbops\n",
      "40\n",
      "prior\n",
      "19.008407591826153\n",
      "19.010163604254284\n",
      "C\n",
      "96 99.51486808606595\n",
      "simu\n",
      "[[4.83175595 4.94461061 5.09315521 ... 4.75456855 4.49743488 5.05380293]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " ...\n",
      " [4.83210986 4.93522071 5.09555699 ... 4.75075685 4.49910687 5.05944427]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " [4.83380007 4.94638146 5.09969681 ... 4.75349132 4.49874171 5.06226425]]\n",
      "nbops\n",
      "32\n",
      "C\n",
      "C\n",
      "97 99.48583093537601\n",
      "simu\n",
      "[[4.83175595 4.94461061 5.09315521 ... 4.75456855 4.49743488 5.05380293]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " ...\n",
      " [4.83210986 4.93522071 5.09555699 ... 4.75075685 4.49910687 5.05944427]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " [4.83380007 4.94638146 5.09969681 ... 4.75349132 4.49874171 5.06226425]]\n",
      "nbops\n",
      "27\n",
      "prior\n",
      "19.03192625486139\n",
      "19.021776088124742\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "98 99.479775253986\n",
      "simu\n",
      "[[4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]\n",
      " [4.83245165 4.94333666 5.09720938 ... 4.75595528 4.49899444 5.04923979]\n",
      " [4.83245165 4.94333666 5.09720938 ... 4.75595528 4.49899444 5.04923979]\n",
      " ...\n",
      " [4.83182827 4.93637852 5.09569201 ... 4.75815134 4.49379695 5.05748284]\n",
      " [4.83182827 4.93637852 5.09569201 ... 4.75815134 4.49379695 5.05748284]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]]\n",
      "nbops\n",
      "45\n",
      "prior\n",
      "19.01876547753591\n",
      "19.021776088124742\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "99 99.47714311029517\n",
      "simu\n",
      "[[4.83207254 4.94929664 5.09961842 ... 4.7520776  4.50105864 5.05642334]\n",
      " [4.83245165 4.94333666 5.09720938 ... 4.75595528 4.49899444 5.04923979]\n",
      " [4.83245165 4.94333666 5.09720938 ... 4.75595528 4.49899444 5.04923979]\n",
      " ...\n",
      " [4.83182827 4.93637852 5.09569201 ... 4.75815134 4.49379695 5.05748284]\n",
      " [4.83182827 4.93637852 5.09569201 ... 4.75815134 4.49379695 5.05748284]\n",
      " [4.83179694 4.94331655 5.09299958 ... 4.75026728 4.49977212 5.06041857]]\n",
      "nbops\n",
      "37\n",
      "prior\n",
      "19.0124852029445\n",
      "19.018110025162002\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "100 99.47475166013037\n",
      "simu\n",
      "[[4.83247011 4.94871372 5.09933909 ... 4.75188392 4.50270716 5.05297158]\n",
      " [4.83193112 4.94524695 5.09678052 ... 4.75348091 4.49926546 5.05529796]\n",
      " [4.83175008 4.94591244 5.09813701 ... 4.75395155 4.49939217 5.05197342]\n",
      " ...\n",
      " [4.83173128 4.93778943 5.09116063 ... 4.75685591 4.49486276 5.05341603]\n",
      " [4.83221936 4.94495398 5.09675165 ... 4.75520886 4.4992739  5.05134464]\n",
      " [4.83228678 4.9455459  5.10150851 ... 4.75384545 4.50097678 5.05302063]]\n",
      "nbops\n",
      "39\n",
      "prior\n",
      "19.01699711795585\n",
      "19.018110025162002\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "101 99.47272403789998\n",
      "simu\n",
      "[[4.83247011 4.94871372 5.09933909 ... 4.75188392 4.50270716 5.05297158]\n",
      " [4.83193112 4.94524695 5.09678052 ... 4.75348091 4.49926546 5.05529796]\n",
      " [4.83175008 4.94591244 5.09813701 ... 4.75395155 4.49939217 5.05197342]\n",
      " ...\n",
      " [4.83173128 4.93778943 5.09116063 ... 4.75685591 4.49486276 5.05341603]\n",
      " [4.83235869 4.94673313 5.09703174 ... 4.7515348  4.50105777 5.05681707]\n",
      " [4.83228678 4.9455459  5.10150851 ... 4.75384545 4.50097678 5.05302063]]\n",
      "nbops\n",
      "37\n",
      "prior\n",
      "19.017851024348538\n",
      "19.018110025162002\n",
      "C\n",
      "C\n",
      "C\n",
      "102 99.46693941152085\n",
      "simu\n",
      "[[4.83209851 4.95349125 5.10266056 ... 4.74900708 4.50523596 5.05438592]\n",
      " [4.83193112 4.94524695 5.09678052 ... 4.75348091 4.49926546 5.05529796]\n",
      " [4.83175008 4.94591244 5.09813701 ... 4.75395155 4.49939217 5.05197342]\n",
      " ...\n",
      " [4.83173128 4.93778943 5.09116063 ... 4.75685591 4.49486276 5.05341603]\n",
      " [4.83235869 4.94673313 5.09703174 ... 4.7515348  4.50105777 5.05681707]\n",
      " [4.83228678 4.9455459  5.10150851 ... 4.75384545 4.50097678 5.05302063]]\n",
      "nbops\n",
      "28\n",
      "prior\n",
      "19.013459669429103\n",
      "19.015690309769706\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "C\n",
      "103 99.46544530243264\n",
      "simu\n",
      "[[4.83175146 4.94460128 5.09599849 ... 4.7544333  4.4981427  5.05401457]\n",
      " [4.83265659 4.94708919 5.10058262 ... 4.75104279 4.50326412 5.05474057]\n",
      " [4.83207254 4.94929664 5.09961842 ... 4.7520776  4.50105864 5.05642334]\n",
      " ...\n",
      " [4.83219158 4.94522945 5.10005112 ... 4.75383755 4.4999148  5.05470477]\n",
      " [4.83237679 4.94290964 5.09906705 ... 4.75285235 4.50021583 5.05684659]\n",
      " [4.83136785 4.9423831  5.09609265 ... 4.76065929 4.49422667 5.04550425]]\n",
      "nbops\n",
      "49\n",
      "prior\n",
      "19.019462210348312\n",
      "19.015690309769706\n",
      "C\n",
      "C\n",
      "C\n",
      "104 99.46396610624909\n",
      "simu\n",
      "[[4.83175486 4.94501861 5.09942217 ... 4.75170346 4.50022611 5.05833464]\n",
      " [4.83265659 4.94708919 5.10058262 ... 4.75104279 4.50326412 5.05474057]\n",
      " [4.83207254 4.94929664 5.09961842 ... 4.7520776  4.50105864 5.05642334]\n",
      " ...\n",
      " [4.83219158 4.94522945 5.10005112 ... 4.75383755 4.4999148  5.05470477]\n",
      " [4.83237679 4.94290964 5.09906705 ... 4.75285235 4.50021583 5.05684659]\n",
      " [4.83136785 4.9423831  5.09609265 ... 4.76065929 4.49422667 5.04550425]]\n",
      "nbops\n",
      "41\n",
      "prior\n",
      "19.01840444470362\n",
      "19.019462210348312\n",
      "C\n",
      "C\n",
      "C\n",
      "105 99.46316918122791\n",
      "simu\n",
      "[[4.83175486 4.94501861 5.09942217 ... 4.75170346 4.50022611 5.05833464]\n",
      " [4.83265659 4.94708919 5.10058262 ... 4.75104279 4.50326412 5.05474057]\n",
      " [4.83207254 4.94929664 5.09961842 ... 4.7520776  4.50105864 5.05642334]\n",
      " ...\n",
      " [4.83219158 4.94522945 5.10005112 ... 4.75383755 4.4999148  5.05470477]\n",
      " [4.83237679 4.94290964 5.09906705 ... 4.75285235 4.50021583 5.05684659]\n",
      " [4.83136785 4.9423831  5.09609265 ... 4.76065929 4.49422667 5.04550425]]\n",
      "nbops\n",
      "33\n",
      "prior\n",
      "19.01646152714044\n",
      "19.019462210348312\n",
      "C\n",
      "C\n",
      "106 99.46076336301049\n",
      "simu\n",
      "[[4.83175486 4.94501861 5.09942217 ... 4.75170346 4.50022611 5.05833464]\n",
      " [4.83265659 4.94708919 5.10058262 ... 4.75104279 4.50326412 5.05474057]\n",
      " [4.83207254 4.94929664 5.09961842 ... 4.7520776  4.50105864 5.05642334]\n",
      " ...\n",
      " [4.83219158 4.94522945 5.10005112 ... 4.75383755 4.4999148  5.05470477]\n",
      " [4.8323801  4.94539228 5.0987336  ... 4.74994184 4.50261068 5.05741208]\n",
      " [4.83136785 4.9423831  5.09609265 ... 4.76065929 4.49422667 5.04550425]]\n",
      "nbops\n",
      "24\n",
      "prior\n",
      "19.01677405096102\n",
      "19.013841228592977\n"
     ]
    }
   ],
   "source": [
    "l = 50\n",
    "data = np.random.normal(5, 1, (l,1000))\n",
    "\n",
    "def rprior(n):\n",
    "    res = np.zeros((n,l+1))\n",
    "    res[:,0] = np.random.uniform(4,6,size = n)\n",
    "    for i in range(n):\n",
    "        res[i,1:l+1] = np.random.normal(res[i,0],1,l)\n",
    "    return(res)\n",
    "\n",
    "statdata = np.array([np.percentile(data[i], np.arange(10, 91, 10)) for i in range(l)])\n",
    "\n",
    "def dprior(simu):\n",
    "    return(np.sum(norm.pdf(simu[1:l+1], loc=simu[0], scale=1)))\n",
    "\n",
    "lev = np.arange(0.1, 0.91, 0.1)\n",
    "def dist(simu):\n",
    "    s = simu[1:l+1]\n",
    "    quantiles = np.array([sps.norm(s[i],1).ppf(lev) for i in range(l)])\n",
    "    return(np.sum(abs(quantiles - statdata)))\n",
    "\n",
    "smc(data, 50, 150, 50, 0.85, rprior, dprior, dist, l)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "15f4a137-4635-43df-9180-690e4b1cfe3a",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "f486c53b-f78a-4846-84f6-6ba97c90acdb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157]])"
      ]
     },
     "execution_count": 96,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lev = np.arange(0.1, 0.91, 0.1)\n",
    "np.array([[sps.norm(0,1).ppf(lev[j])for j in range(9)] for i in range(20)])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "72febd11-d6d7-4ca2-b743-ff72fd0c8811",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4.994917708904839"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.mean(data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "ec9deb80-4b1e-44d9-9050-22c087304327",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[-1.22632763, -0.96757533, -0.39301757, -0.20397749,  0.14693889,\n",
       "         0.37491585,  0.6289771 ,  0.92455755,  1.38612635],\n",
       "       [-1.44296325, -0.92307548, -0.56156128, -0.39494026, -0.2664423 ,\n",
       "        -0.00636477,  0.30104914,  0.79924288,  1.24402695],\n",
       "       [-1.04964449, -0.70018076, -0.39034465, -0.2240184 , -0.01453115,\n",
       "         0.14606471,  0.33530056,  0.62722259,  1.30862775],\n",
       "       [-1.49909209, -1.0028768 , -0.79626747, -0.31251036,  0.03944439,\n",
       "         0.21273599,  0.39171022,  0.62138397,  1.10633739],\n",
       "       [-1.00312275, -0.5279426 , -0.15478898, -0.02036877,  0.10632089,\n",
       "         0.27521066,  0.5321973 ,  0.86913597,  1.00471078],\n",
       "       [-1.02707699, -0.59789934, -0.33801833,  0.11657606,  0.30406687,\n",
       "         0.40774515,  0.58181003,  0.84903717,  1.39213776],\n",
       "       [-1.44728498, -1.1295602 , -0.70792207, -0.47793317, -0.11071702,\n",
       "         0.15321368,  0.32667567,  0.83899428,  1.06471114],\n",
       "       [-0.97542639, -0.34560624, -0.14772612,  0.1749131 ,  0.3927516 ,\n",
       "         0.50725874,  0.72367107,  0.82940629,  1.00850274],\n",
       "       [-1.5037043 , -1.13048535, -0.60325476, -0.47765272, -0.09980087,\n",
       "         0.25815378,  0.38626593,  0.61657686,  1.34272723],\n",
       "       [-0.84478931, -0.59635643, -0.21940719, -0.05321533,  0.27148184,\n",
       "         0.45277276,  0.81611672,  1.21705014,  1.41001786],\n",
       "       [-0.84299222, -0.59341696, -0.50407804, -0.3477463 , -0.1978683 ,\n",
       "         0.16800661,  0.29112907,  0.83553183,  1.24473185],\n",
       "       [-1.33896942, -0.86399052, -0.58659088, -0.30205378, -0.08560411,\n",
       "         0.15951456,  0.32521032,  0.57569444,  1.31186808],\n",
       "       [-1.28206288, -1.00076582, -0.65249426, -0.34110119, -0.0706208 ,\n",
       "         0.16200371,  0.51191737,  0.69286209,  0.90702986],\n",
       "       [-1.31524971, -1.10426677, -0.8574561 , -0.52029216, -0.19252748,\n",
       "         0.15492195,  0.46874699,  0.8026502 ,  1.05731233],\n",
       "       [-0.99953722, -0.31769806, -0.20247038, -0.08195423,  0.02905979,\n",
       "         0.24167693,  0.52902993,  0.68477334,  0.98999741],\n",
       "       [-0.94768259, -0.6316389 , -0.21408991,  0.09606892,  0.3681682 ,\n",
       "         0.58867389,  0.72623814,  0.85587464,  1.2196952 ],\n",
       "       [-1.31023999, -0.88147138, -0.57809946, -0.36956493, -0.15188463,\n",
       "         0.1984757 ,  0.43363991,  0.68719483,  1.25402875],\n",
       "       [-1.34485825, -1.09924007, -0.84053182, -0.67301396, -0.19389305,\n",
       "         0.01162688,  0.11968165,  0.33932089,  0.86796034],\n",
       "       [-1.38601635, -0.87887224, -0.64766741, -0.37073421,  0.17733218,\n",
       "         0.43792077,  0.68759327,  0.82334529,  1.23852248],\n",
       "       [-1.61388065, -0.7082339 , -0.33398495, -0.02213554,  0.12303499,\n",
       "         0.29447909,  0.65797989,  0.94777721,  1.26470461]])"
      ]
     },
     "execution_count": 95,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = np.random.normal(0, 1, (20,l))\n",
    "\n",
    "def rprior(n):\n",
    "    means = np.random.uniform(-10,10,size = n)\n",
    "    res = [0]*n\n",
    "    for i in range(n):\n",
    "        res[i] = np.random.normal(means[i],1,l)\n",
    "    return(res,means)\n",
    "\n",
    "np.array([np.percentile(data[i], np.arange(10, 91, 10)) for i in range(20)])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "id": "c9d7dde6-c941-4cd4-8611-73cc077d9d60",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "156.34695097571228"
      ]
     },
     "execution_count": 119,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "l = 50\n",
    "data = np.random.normal(0, 1, (20,l))\n",
    "\n",
    "def rprior(n):\n",
    "    means = np.random.uniform(-10,10,size = n)\n",
    "    res = [0]*n\n",
    "    for i in range(n):\n",
    "        res[i] = np.random.normal(means[i],1,l)\n",
    "    return(res,means)\n",
    "\n",
    "statdata = np.array([np.percentile(data[i], np.arange(10, 91, 10)) for i in range(20)])\n",
    "\n",
    "def dprior(simu):\n",
    "    return(np.sum(norm.pdf(simu, loc=simu[1], scale=1)))\n",
    "\n",
    "def dist(simu):\n",
    "    lev = np.arange(0.1, 0.91, 0.1)\n",
    "    quantiles = np.array([[sps.norm(simu[i],1).ppf(lev[j])for j in range(9)] for i in range(20)])\n",
    "    return(np.sum(abs(quantiles - statdata)))\n",
    "\n",
    "dist(np.random.normal(0, 1, (l)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "4b29e06b-4451-4472-9fb0-60f8fe9f4b48",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[2, 3],\n",
       "       [2, 3],\n",
       "       [2, 3]])"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.tile([1,2,3],(3,1))[:,1:3]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "d771dc0a-8f2a-49a5-9c50-59aea9765ed7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.71844843, 1.15837877, 1.47559949])"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sps.norm(2,1).ppf([0.1,0.2,0.3])"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
