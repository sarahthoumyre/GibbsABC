{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "12b413b6-1b6a-4594-bed6-caae6144f0e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#!pip install arviz\n",
    "#!pip install pymc\n",
    "import arviz as az\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "import pymc as pm\n",
    "import scipy.integrate as integrate\n",
    "from scipy.stats import uniform, norm\n",
    "import scipy.stats as sps\n",
    "from random import choices\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "ef4ee381-8c34-4470-a99a-9169cd7f4948",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[31mERROR: Could not find a version that satisfies the requirement gk (from versions: none)\u001b[0m\u001b[31m\n",
      "\u001b[0m\u001b[31mERROR: No matching distribution found for gk\u001b[0m\u001b[31m\n",
      "\u001b[0m"
     ]
    }
   ],
   "source": [
    "!pip install gk"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "59e04b60-87b4-4cb8-9fb5-e4bb16f72930",
   "metadata": {},
   "outputs": [],
   "source": [
    "def changementeps(distances, eps, poids, alpha, n):\n",
    "    epsilons = np.sort(distances[distances<eps])[::-1]\n",
    "    #print(epsilons)\n",
    "    nbops = len(epsilons)\n",
    "    print(\"nbops\")\n",
    "    print(nbops)\n",
    "    ESS = 1/sum(poids**2)\n",
    "    k = 0\n",
    "    nouvpoids = poids\n",
    "    while (k<nbops-1):\n",
    "        nouveps = epsilons[k]\n",
    "        a=True\n",
    "        for i in range(n):\n",
    "            if (poids[i] != 0) :   \n",
    "                if (sum(distances[:,i][np.where(distances[:,i] <= eps)]) == 0):\n",
    "                    nouvpoids[i]=0\n",
    "                else:\n",
    "                    nouvpoids[i] = poids[i] * sum(distances[:,i][np.where(distances[:,i] <= nouveps)]) / sum(distances[:,i][np.where(distances[:,i] <= eps)])\n",
    "        nouvpoids = nouvpoids / sum(nouvpoids)\n",
    "        nouvESS = 1/sum(nouvpoids**2)\n",
    "        if nouvESS < (alpha * ESS) :\n",
    "            return(nouveps,nouvpoids,nouvESS)\n",
    "        k += 1\n",
    "    return(eps,poids,ESS)\n",
    "\n",
    "def chgtpar(simui, distancesi, sd, eps, data, dprior, dist, n, means, M):\n",
    "    simu = simui + np.random.multivariate_normal(np.zeros(len(sd)),cov=sd)\n",
    "    #print(simu)\n",
    "    ndistances = np.tile([dist(simu)], M)\n",
    "    u = np.random.uniform(1)\n",
    "    #print(distances, distancesi)\n",
    "    if (u < (sum(ndistances[np.where(ndistances <= eps)] / sum(distancesi[np.where(distancesi <= eps)]) * dprior(simu,means) / dprior(simui,means)))):\n",
    "        return(simu, ndistances)\n",
    "    else :\n",
    "        return(simui, distancesi)\n",
    "\n",
    "def pasnoyau(simu, eps, distances, poids, data, dprior, dist, n, means, M):\n",
    "    sd = 2 * np.cov(np.transpose(simu))\n",
    "    mdistances = np.copy(distances)\n",
    "    for i in range(n):\n",
    "        if (poids[i] > 0) :\n",
    "            simu[i], mdistances[:i] = chgtpar(simu[i], mdistances[:i], sd, eps, data, dprior, dist, n, means, M)\n",
    "    return(simu, mdistances)\n",
    "        \n",
    "\n",
    "def smc(data, n, M, T, objectifeps, alpha, rprior, dprior, dist, l):\n",
    "    simu, means = rprior(n)\n",
    "    distances = np.tile([dist(i) for i in simu],(M,1))\n",
    "    print(distances)\n",
    "    j=1\n",
    "    poids = np.array([1/n]*n)\n",
    "    ESS = n\n",
    "    eps = np.max(distances)\n",
    "    histeps = [eps]\n",
    "    while ((j<T) and (eps>objectifeps)):\n",
    "        (eps, poids, ESS) = changementeps(distances, eps, poids, alpha, n)\n",
    "        histeps.append(eps)\n",
    "        if (ESS < n / 2) :\n",
    "            simu = choices(simu, weights = poids, k = n)\n",
    "            poids = np.array([1/n]*n)\n",
    "            ESS = n\n",
    "            distances = np.tile([dist(i) for i in simu],(M,1))\n",
    "        print(distances.shape)\n",
    "        simu, distances = pasnoyau(simu, eps, distances, poids, data, dprior, dist, n, means, M)\n",
    "        print(j,eps)\n",
    "        j += 1\n",
    "    simu = choices(simu, weights = poids, k = n)\n",
    "    #poids = np.array([1/n]*n)\n",
    "    ESS = n\n",
    "    distances = np.array([dist(i) for i in simu]*M)\n",
    "    return(simu, poids, distances, histeps)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "5065709f-6b8a-46d0-84c1-13ce3abbf169",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[ 683.82996897  188.83038501 1468.01576425 ...  507.79878493\n",
      "   199.18877348 1742.16875601]\n",
      " [ 683.82996897  188.83038501 1468.01576425 ...  507.79878493\n",
      "   199.18877348 1742.16875601]\n",
      " [ 683.82996897  188.83038501 1468.01576425 ...  507.79878493\n",
      "   199.18877348 1742.16875601]\n",
      " ...\n",
      " [ 683.82996897  188.83038501 1468.01576425 ...  507.79878493\n",
      "   199.18877348 1742.16875601]\n",
      " [ 683.82996897  188.83038501 1468.01576425 ...  507.79878493\n",
      "   199.18877348 1742.16875601]\n",
      " [ 683.82996897  188.83038501 1468.01576425 ...  507.79878493\n",
      "   199.18877348 1742.16875601]]\n",
      "nbops\n",
      "2450\n",
      "(50, 50)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_4096/3145865049.py:32: RuntimeWarning: divide by zero encountered in divide\n",
      "  if (u < (sum(ndistances[np.where(ndistances <= eps)] / sum(distancesi[np.where(distancesi <= eps)]) * dprior(simu,means) / dprior(simui,means)))):\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1 1862.3653290811696\n",
      "nbops\n",
      "2157\n",
      "(50, 50)\n",
      "2 1468.015764246602\n",
      "nbops\n",
      "1912\n",
      "(50, 50)\n",
      "3 1333.162938034694\n",
      "nbops\n",
      "1666\n",
      "(50, 50)\n",
      "4 1047.7976224901206\n",
      "nbops\n",
      "1470\n",
      "(50, 50)\n",
      "5 794.1753059637997\n",
      "nbops\n",
      "1372\n",
      "(50, 50)\n",
      "6 682.817788134222\n",
      "nbops\n",
      "2300\n",
      "(50, 50)\n",
      "7 623.4612446810598\n",
      "nbops\n",
      "2150\n",
      "(50, 50)\n",
      "8 569.5599019939478\n",
      "nbops\n",
      "1750\n",
      "(50, 50)\n",
      "9 507.79878493286503\n",
      "nbops\n",
      "1300\n",
      "(50, 50)\n",
      "10 480.3502986243752\n",
      "nbops\n",
      "1177\n",
      "(50, 50)\n",
      "11 436.36760044920186\n",
      "nbops\n",
      "2400\n",
      "(50, 50)\n",
      "12 335.0626520267824\n",
      "nbops\n",
      "2050\n",
      "(50, 50)\n",
      "13 282.2781894566858\n",
      "nbops\n",
      "1200\n",
      "(50, 50)\n",
      "14 257.0353524286374\n",
      "nbops\n",
      "2059\n",
      "(50, 50)\n",
      "15 228.79582495470422\n",
      "nbops\n",
      "2010\n",
      "(50, 50)\n",
      "16 199.18877348257342\n",
      "nbops\n",
      "1520\n",
      "(50, 50)\n",
      "17 187.90883689639648\n",
      "nbops\n",
      "1422\n",
      "(50, 50)\n",
      "18 135.82218043874127\n",
      "nbops\n",
      "0\n",
      "(50, 50)\n",
      "19 135.82218043874127\n",
      "nbops\n",
      "0\n",
      "(50, 50)\n",
      "20 135.82218043874127\n",
      "nbops\n",
      "0\n",
      "(50, 50)\n",
      "21 135.82218043874127\n",
      "nbops\n",
      "0\n",
      "(50, 50)\n",
      "22 135.82218043874127\n",
      "nbops\n",
      "0\n",
      "(50, 50)\n",
      "23 135.82218043874127\n",
      "nbops\n",
      "0\n",
      "(50, 50)\n",
      "24 135.82218043874127\n",
      "nbops\n",
      "0\n",
      "(50, 50)\n",
      "25 135.82218043874127\n",
      "nbops\n",
      "0\n",
      "(50, 50)\n",
      "26 135.82218043874127\n",
      "nbops\n",
      "0\n",
      "(50, 50)\n",
      "27 135.82218043874127\n",
      "nbops\n",
      "0\n",
      "(50, 50)\n",
      "28 135.82218043874127\n",
      "nbops\n",
      "50\n",
      "(50, 50)\n",
      "29 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "30 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "31 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "32 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "33 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "34 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "35 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "36 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "37 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "38 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "39 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "40 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "41 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "42 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "43 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "44 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "45 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "46 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "47 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "48 135.54917897514554\n",
      "nbops\n",
      "1000\n",
      "(50, 50)\n",
      "49 135.54917897514554\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "([array([-4.50125181, -5.33319893, -4.46225591, -5.04799336, -6.45383387,\n",
       "         -3.67289772, -4.608203  , -4.77045956, -1.97090844, -4.07697125,\n",
       "         -6.23204641, -6.03803574, -5.01636559, -6.39934684, -5.35264964,\n",
       "         -5.14355509, -3.83395069, -4.3047921 , -5.45852754, -4.36592377,\n",
       "         -6.65427255, -3.64378288, -4.03575408, -5.43240749, -4.84997537,\n",
       "         -4.98503577, -5.55031699, -5.75256602, -5.9429142 , -5.18027937,\n",
       "         -4.73105858, -7.27346444, -4.40159918, -5.81641377, -5.97378287,\n",
       "         -5.19310126, -3.99034578, -4.45765126, -5.20179154, -6.6634572 ,\n",
       "         -3.11133092, -6.30373602, -4.79267965, -7.31233957, -6.17593052,\n",
       "         -4.58979101, -3.63897356, -3.98851868, -6.56563722, -6.08944878]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([-4.50125181, -5.33319893, -4.46225591, -5.04799336, -6.45383387,\n",
       "         -3.67289772, -4.608203  , -4.77045956, -1.97090844, -4.07697125,\n",
       "         -6.23204641, -6.03803574, -5.01636559, -6.39934684, -5.35264964,\n",
       "         -5.14355509, -3.83395069, -4.3047921 , -5.45852754, -4.36592377,\n",
       "         -6.65427255, -3.64378288, -4.03575408, -5.43240749, -4.84997537,\n",
       "         -4.98503577, -5.55031699, -5.75256602, -5.9429142 , -5.18027937,\n",
       "         -4.73105858, -7.27346444, -4.40159918, -5.81641377, -5.97378287,\n",
       "         -5.19310126, -3.99034578, -4.45765126, -5.20179154, -6.6634572 ,\n",
       "         -3.11133092, -6.30373602, -4.79267965, -7.31233957, -6.17593052,\n",
       "         -4.58979101, -3.63897356, -3.98851868, -6.56563722, -6.08944878]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([-4.50125181, -5.33319893, -4.46225591, -5.04799336, -6.45383387,\n",
       "         -3.67289772, -4.608203  , -4.77045956, -1.97090844, -4.07697125,\n",
       "         -6.23204641, -6.03803574, -5.01636559, -6.39934684, -5.35264964,\n",
       "         -5.14355509, -3.83395069, -4.3047921 , -5.45852754, -4.36592377,\n",
       "         -6.65427255, -3.64378288, -4.03575408, -5.43240749, -4.84997537,\n",
       "         -4.98503577, -5.55031699, -5.75256602, -5.9429142 , -5.18027937,\n",
       "         -4.73105858, -7.27346444, -4.40159918, -5.81641377, -5.97378287,\n",
       "         -5.19310126, -3.99034578, -4.45765126, -5.20179154, -6.6634572 ,\n",
       "         -3.11133092, -6.30373602, -4.79267965, -7.31233957, -6.17593052,\n",
       "         -4.58979101, -3.63897356, -3.98851868, -6.56563722, -6.08944878]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([-4.50125181, -5.33319893, -4.46225591, -5.04799336, -6.45383387,\n",
       "         -3.67289772, -4.608203  , -4.77045956, -1.97090844, -4.07697125,\n",
       "         -6.23204641, -6.03803574, -5.01636559, -6.39934684, -5.35264964,\n",
       "         -5.14355509, -3.83395069, -4.3047921 , -5.45852754, -4.36592377,\n",
       "         -6.65427255, -3.64378288, -4.03575408, -5.43240749, -4.84997537,\n",
       "         -4.98503577, -5.55031699, -5.75256602, -5.9429142 , -5.18027937,\n",
       "         -4.73105858, -7.27346444, -4.40159918, -5.81641377, -5.97378287,\n",
       "         -5.19310126, -3.99034578, -4.45765126, -5.20179154, -6.6634572 ,\n",
       "         -3.11133092, -6.30373602, -4.79267965, -7.31233957, -6.17593052,\n",
       "         -4.58979101, -3.63897356, -3.98851868, -6.56563722, -6.08944878]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([-4.35416839, -5.35698401, -4.49594294, -5.07546422, -6.38712528,\n",
       "         -3.80660926, -4.5649601 , -4.97551797, -2.24161617, -4.09878056,\n",
       "         -6.18235485, -6.33263696, -5.12770507, -6.76991017, -5.31990407,\n",
       "         -5.04714566, -4.03238103, -4.69941725, -5.68648838, -4.34123458,\n",
       "         -7.42274284, -4.03594124, -3.88000902, -5.6449384 , -5.00163016,\n",
       "         -5.08089248, -5.47238475, -5.77046711, -6.51879321, -5.34551988,\n",
       "         -4.98634327, -7.64512108, -4.89215368, -5.97294837, -6.08356631,\n",
       "         -5.71593757, -4.15527257, -4.69791735, -5.46007283, -6.93389101,\n",
       "         -3.27363511, -6.25810265, -4.74932417, -7.42820758, -6.3100607 ,\n",
       "         -4.55983492, -3.78229414, -4.06944655, -6.6557921 , -5.94151887]),\n",
       "  array([-4.50125181, -5.33319893, -4.46225591, -5.04799336, -6.45383387,\n",
       "         -3.67289772, -4.608203  , -4.77045956, -1.97090844, -4.07697125,\n",
       "         -6.23204641, -6.03803574, -5.01636559, -6.39934684, -5.35264964,\n",
       "         -5.14355509, -3.83395069, -4.3047921 , -5.45852754, -4.36592377,\n",
       "         -6.65427255, -3.64378288, -4.03575408, -5.43240749, -4.84997537,\n",
       "         -4.98503577, -5.55031699, -5.75256602, -5.9429142 , -5.18027937,\n",
       "         -4.73105858, -7.27346444, -4.40159918, -5.81641377, -5.97378287,\n",
       "         -5.19310126, -3.99034578, -4.45765126, -5.20179154, -6.6634572 ,\n",
       "         -3.11133092, -6.30373602, -4.79267965, -7.31233957, -6.17593052,\n",
       "         -4.58979101, -3.63897356, -3.98851868, -6.56563722, -6.08944878]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([-4.50125181, -5.33319893, -4.46225591, -5.04799336, -6.45383387,\n",
       "         -3.67289772, -4.608203  , -4.77045956, -1.97090844, -4.07697125,\n",
       "         -6.23204641, -6.03803574, -5.01636559, -6.39934684, -5.35264964,\n",
       "         -5.14355509, -3.83395069, -4.3047921 , -5.45852754, -4.36592377,\n",
       "         -6.65427255, -3.64378288, -4.03575408, -5.43240749, -4.84997537,\n",
       "         -4.98503577, -5.55031699, -5.75256602, -5.9429142 , -5.18027937,\n",
       "         -4.73105858, -7.27346444, -4.40159918, -5.81641377, -5.97378287,\n",
       "         -5.19310126, -3.99034578, -4.45765126, -5.20179154, -6.6634572 ,\n",
       "         -3.11133092, -6.30373602, -4.79267965, -7.31233957, -6.17593052,\n",
       "         -4.58979101, -3.63897356, -3.98851868, -6.56563722, -6.08944878]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([-4.50125181, -5.33319893, -4.46225591, -5.04799336, -6.45383387,\n",
       "         -3.67289772, -4.608203  , -4.77045956, -1.97090844, -4.07697125,\n",
       "         -6.23204641, -6.03803574, -5.01636559, -6.39934684, -5.35264964,\n",
       "         -5.14355509, -3.83395069, -4.3047921 , -5.45852754, -4.36592377,\n",
       "         -6.65427255, -3.64378288, -4.03575408, -5.43240749, -4.84997537,\n",
       "         -4.98503577, -5.55031699, -5.75256602, -5.9429142 , -5.18027937,\n",
       "         -4.73105858, -7.27346444, -4.40159918, -5.81641377, -5.97378287,\n",
       "         -5.19310126, -3.99034578, -4.45765126, -5.20179154, -6.6634572 ,\n",
       "         -3.11133092, -6.30373602, -4.79267965, -7.31233957, -6.17593052,\n",
       "         -4.58979101, -3.63897356, -3.98851868, -6.56563722, -6.08944878]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851]),\n",
       "  array([ -3.59772125,  -5.47931045,  -4.669195  ,  -5.21674653,\n",
       "          -6.04404379,  -4.49428495,  -4.34256306,  -6.03012886,\n",
       "          -3.63385963,  -4.21094486,  -5.92679221,  -7.84776525,\n",
       "          -5.70032166,  -8.67570947,  -5.15149515,  -4.55131324,\n",
       "          -5.05290404,  -6.72896654,  -6.858886  ,  -4.21425837,\n",
       "         -11.37497127,  -6.05280329,  -3.07901509,  -6.73798031,\n",
       "          -5.78158726,  -5.57388195,  -5.07158084,  -5.86253182,\n",
       "          -9.48052747,  -6.1953494 ,  -6.29926717,  -9.55654321,\n",
       "          -7.41506542,  -6.77800333,  -6.64817996,  -8.4048734 ,\n",
       "          -5.00348771,  -5.93360164,  -6.78840844,  -8.32472655,\n",
       "          -4.10836257,  -6.02341095,  -4.52634755,  -8.02411449,\n",
       "          -6.99988945,  -4.40577113,  -4.51939003,  -4.48565716,\n",
       "          -7.11945656,  -5.18071851])],\n",
       " array([0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02,\n",
       "        0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02,\n",
       "        0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02,\n",
       "        0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02,\n",
       "        0.02, 0.02, 0.02, 0.02, 0.02, 0.02]),\n",
       " array([135.82218044, 187.60394252, 187.60394252, ..., 187.60394252,\n",
       "        187.60394252, 187.60394252]),\n",
       " [2547.43933500023,\n",
       "  1862.3653290811696,\n",
       "  1468.015764246602,\n",
       "  1333.162938034694,\n",
       "  1047.7976224901206,\n",
       "  794.1753059637997,\n",
       "  682.817788134222,\n",
       "  623.4612446810598,\n",
       "  569.5599019939478,\n",
       "  507.79878493286503,\n",
       "  480.3502986243752,\n",
       "  436.36760044920186,\n",
       "  335.0626520267824,\n",
       "  282.2781894566858,\n",
       "  257.0353524286374,\n",
       "  228.79582495470422,\n",
       "  199.18877348257342,\n",
       "  187.90883689639648,\n",
       "  135.82218043874127,\n",
       "  135.82218043874127,\n",
       "  135.82218043874127,\n",
       "  135.82218043874127,\n",
       "  135.82218043874127,\n",
       "  135.82218043874127,\n",
       "  135.82218043874127,\n",
       "  135.82218043874127,\n",
       "  135.82218043874127,\n",
       "  135.82218043874127,\n",
       "  135.82218043874127,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554,\n",
       "  135.54917897514554])"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "l = 50\n",
    "data = np.random.normal(-5, 1, (20,l))\n",
    "\n",
    "def rprior(n):\n",
    "    means = np.random.uniform(-10,10,size = n)\n",
    "    res = [0]*n\n",
    "    for i in range(n):\n",
    "        res[i] = np.random.normal(means[i],1,l)\n",
    "    return(res,means)\n",
    "\n",
    "statdata = np.array([np.percentile(data[i], np.arange(10, 91, 10)) for i in range(20)])\n",
    "\n",
    "def dprior(simu,means):\n",
    "    return(np.sum(norm.pdf(simu, loc=means, scale=1)))\n",
    "\n",
    "def dist(simu):\n",
    "    lev = np.arange(0.1, 0.91, 0.1)\n",
    "    quantiles = np.array([[sps.norm(simu[i],1).ppf(lev[j])for j in range(9)] for i in range(20)])\n",
    "    return(np.sum(abs(quantiles - statdata)))\n",
    "\n",
    "smc(data, 50, 50, 50, 150, 0.9, rprior, dprior, dist, l)\n",
    "           \n",
    "#smc(.,.,.,.,.,.,lambda x : np.random.uniform(size = x),.,l)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 169,
   "id": "27b67873-3bf5-4d3b-bb8e-d23e3be5097e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 1.14300981e+00,  7.23000039e-01, -9.93657375e-02,\n",
       "        -1.18467928e+00,  1.16173018e+00, -2.29294434e+00,\n",
       "         7.41899761e-01,  1.85956366e-01, -1.09490732e+00,\n",
       "        -4.10943157e-01,  9.50964283e-02,  5.95530641e-01,\n",
       "         6.41885243e-01, -8.47788483e-01, -4.47915231e-01,\n",
       "        -1.35739315e+00, -7.37665918e-01, -4.34445147e-01,\n",
       "        -3.91672255e-01,  5.73217372e-01, -2.88070483e-01,\n",
       "         3.55776367e-01, -2.99554238e-01,  1.45798614e+00,\n",
       "         1.63922154e+00, -6.78473799e-01,  1.09049887e+00,\n",
       "        -1.00425997e+00, -2.12571256e-01,  8.57885088e-01,\n",
       "        -7.87559646e-01, -3.58762907e-01,  1.08809418e+00,\n",
       "        -2.38742935e+00,  4.28606226e-03, -1.08117323e+00,\n",
       "         5.43706218e-01, -1.12549646e-01,  2.46561950e+00,\n",
       "         1.09513812e+00, -3.22118983e-01,  7.86767243e-01,\n",
       "        -1.30025173e+00, -1.17708705e+00, -1.47932316e+00,\n",
       "        -7.09729489e-01,  1.52335685e+00, -7.96703998e-01,\n",
       "        -1.18088898e+00, -1.14511035e+00],\n",
       "       [ 1.14509923e+00,  1.82284356e+00,  1.44159943e+00,\n",
       "         2.53955918e+00,  5.12405173e-01, -5.36808612e-01,\n",
       "        -5.61328686e-01,  4.87409452e-01,  7.21605526e-01,\n",
       "        -2.81497729e-01, -1.09472527e+00,  1.13084353e+00,\n",
       "        -1.01338185e+00, -1.24814647e-02, -1.97743008e-01,\n",
       "         1.19114140e+00,  2.20163217e-01, -4.65124140e-01,\n",
       "         5.10411298e-01,  5.54688168e-01,  1.77192695e+00,\n",
       "        -2.76269530e-01, -5.89712427e-02, -1.15542314e-01,\n",
       "         1.21628879e+00,  1.45098681e+00, -1.29053423e+00,\n",
       "         4.69159999e-01,  3.33419747e-01, -6.52869572e-01,\n",
       "         1.06396172e+00, -5.21932024e-01, -1.61046088e+00,\n",
       "         4.80563048e-01,  3.67247677e-01, -2.01183832e-01,\n",
       "         1.86733523e+00, -8.11032706e-02, -5.35937413e-01,\n",
       "        -5.27469048e-02,  1.17933184e+00,  3.15734354e-01,\n",
       "         9.40490333e-01, -8.89828931e-01,  6.58695142e-01,\n",
       "         1.79852211e-02, -3.84827889e-01, -1.66005988e+00,\n",
       "         1.08668530e+00, -5.79475266e-01],\n",
       "       [ 1.57361229e-01,  1.26124856e+00, -1.23387477e+00,\n",
       "         2.01525435e+00,  5.23853457e-01,  4.18543111e-01,\n",
       "        -2.03259094e-01, -8.00482696e-01,  6.58725223e-01,\n",
       "        -1.22074938e+00,  3.15905183e-01,  8.17831214e-01,\n",
       "        -7.03003729e-01, -1.74871388e+00,  1.26782302e-01,\n",
       "        -1.94732737e-01,  1.11947361e+00, -1.70403031e+00,\n",
       "         9.23433103e-01,  1.77884524e+00,  2.23492570e-01,\n",
       "         2.21127965e-01, -8.31046214e-01, -8.67442489e-01,\n",
       "         1.36762926e+00,  6.51622419e-01, -9.91983006e-01,\n",
       "         5.28437161e-01, -3.31272837e-01,  1.31050264e+00,\n",
       "        -1.53772774e+00, -5.51514980e-01, -7.21748998e-01,\n",
       "         1.01490970e+00, -3.72761520e-01,  1.98538808e-01,\n",
       "         5.91547683e-02,  6.25022869e-01, -2.28831643e-01,\n",
       "         1.62627619e+00,  1.46670220e+00, -3.71395564e-02,\n",
       "         1.06506860e+00, -5.51697365e-01,  1.56466770e+00,\n",
       "         4.16765193e-01, -3.58896543e-01,  8.72937968e-01,\n",
       "        -7.85092968e-02,  6.47204225e-01],\n",
       "       [-2.88984304e-01, -1.01155701e+00, -5.90138160e-01,\n",
       "         1.17993743e+00, -1.22327406e+00, -9.38368816e-01,\n",
       "        -1.83842349e+00,  4.69792947e-01,  1.79039906e+00,\n",
       "        -6.25440345e-01, -9.63144441e-01, -1.24582800e+00,\n",
       "        -1.32282185e+00, -1.76980496e+00, -3.14713243e-01,\n",
       "         1.99047844e+00, -1.66253540e-01, -1.82969993e+00,\n",
       "        -1.59184087e+00,  7.36385512e-01,  1.55460324e-01,\n",
       "         1.97062601e+00,  1.28893818e+00, -1.04659971e+00,\n",
       "        -5.60469957e-01, -1.01914891e+00, -1.34036730e+00,\n",
       "         9.66609598e-01,  4.06626962e-01, -3.39709402e-01,\n",
       "         2.32508153e-01, -6.21066949e-01,  1.16072309e+00,\n",
       "         1.96467088e+00, -6.33776126e-01, -8.13336943e-02,\n",
       "         1.25782670e+00, -2.40154245e+00,  2.80520668e-01,\n",
       "        -1.30717586e-01,  2.68031383e-01, -3.83378328e-01,\n",
       "        -1.33371843e+00, -9.09067222e-01, -1.62324751e+00,\n",
       "         8.96263215e-01,  8.19165837e-01,  1.34513113e+00,\n",
       "         2.62328524e-01, -1.43123368e-01],\n",
       "       [-1.57738245e+00, -2.11177311e-01,  5.81694196e-01,\n",
       "        -1.02099806e+00,  2.11855918e+00,  6.25094460e-01,\n",
       "         1.32793984e+00,  3.02751999e-01,  3.58677067e-01,\n",
       "        -4.05037249e-01, -8.78732981e-01, -1.84752839e+00,\n",
       "        -2.01792277e-01, -2.81620892e-01,  1.31723425e+00,\n",
       "        -1.97818874e-01, -1.73338048e+00, -2.23783587e+00,\n",
       "         1.15868462e+00, -8.32084084e-01,  8.96444977e-01,\n",
       "        -2.14121003e+00,  1.47995132e+00, -9.57217812e-01,\n",
       "        -5.62125628e-01, -3.02235150e-01, -7.01955854e-01,\n",
       "         1.87099503e+00, -1.12500058e+00, -1.79651896e+00,\n",
       "         1.67885618e-01,  1.60597409e+00, -2.74878912e-01,\n",
       "         1.25557675e+00, -1.83384358e-01, -1.15564603e+00,\n",
       "        -3.53510999e-01, -6.09288424e-01,  8.82645975e-01,\n",
       "         3.42330658e-02, -9.62719263e-01,  9.22081380e-01,\n",
       "        -1.73432113e+00, -1.13359171e+00, -6.99651491e-01,\n",
       "        -1.07323127e+00, -2.39828256e+00, -6.06576952e-01,\n",
       "         4.69663468e-01, -4.35597240e-02],\n",
       "       [-9.14669854e-01,  1.97854408e-01,  7.79802718e-01,\n",
       "        -4.02565967e-01,  1.72601311e+00,  2.86802938e-01,\n",
       "        -8.37243039e-01, -6.36759357e-01, -4.11076130e+00,\n",
       "        -9.17895893e-01,  2.21386816e-01, -8.16793377e-02,\n",
       "         1.74407002e-01,  5.67208220e-01, -9.13318645e-01,\n",
       "         1.52169797e-01,  6.44960975e-01, -2.10054735e-01,\n",
       "        -8.66564518e-02, -2.91939633e-01, -2.90046309e-02,\n",
       "         7.38840635e-01, -1.06313825e+00, -5.43400055e-01,\n",
       "         1.89308461e-01,  3.52343864e-01,  2.51045422e-02,\n",
       "        -2.13711141e-01, -2.84127773e-02, -1.31077745e+00,\n",
       "         6.99352354e-01, -1.55593155e+00, -5.70039226e-02,\n",
       "        -2.99886582e+00, -8.57432244e-01, -1.95524920e+00,\n",
       "         7.12491892e-01, -9.51032296e-03,  4.12258840e-01,\n",
       "        -5.84236696e-01, -6.33443927e-01,  1.07672544e+00,\n",
       "         1.49193591e+00,  8.26277111e-01, -1.90576746e+00,\n",
       "        -9.28517182e-01, -3.10302822e-01, -2.55816434e-02,\n",
       "        -6.78293110e-01, -5.60882512e-01],\n",
       "       [ 7.77549032e-01, -9.81515968e-03,  1.07792455e+00,\n",
       "         2.48803138e-01, -2.51302498e-01, -3.26434922e-01,\n",
       "         8.48665341e-01,  1.62980049e+00, -9.88760357e-02,\n",
       "        -5.60498116e-01,  8.93405297e-01,  1.74442985e+00,\n",
       "        -3.48127919e-01, -7.73427112e-01, -8.30855403e-01,\n",
       "        -1.76812121e+00, -6.06970995e-02, -1.34761850e+00,\n",
       "        -1.59503457e+00,  3.35684228e-01, -3.18501310e-01,\n",
       "         8.30740857e-01,  1.09456284e+00,  9.79391475e-01,\n",
       "         2.13623938e-01,  3.25874898e-01, -1.03463607e-01,\n",
       "         2.11678981e-01, -6.65939297e-01, -9.47902102e-01,\n",
       "        -7.04633373e-01, -1.00066952e-01,  2.84682484e-02,\n",
       "        -2.16027288e-01, -2.69735950e-01,  4.49007467e-01,\n",
       "        -3.24270354e-01, -1.59579234e+00,  2.35992508e+00,\n",
       "        -3.21684133e-01,  9.26340525e-01, -4.16249096e-01,\n",
       "         2.58325510e-01, -6.66266907e-01,  1.35654534e+00,\n",
       "         2.15975891e-01,  4.45281605e-01, -1.18184851e+00,\n",
       "         2.68338427e-01,  1.33790306e+00],\n",
       "       [-1.41722219e-02, -9.12950273e-03,  9.41391963e-01,\n",
       "        -1.69854152e-01, -2.92734672e-01, -1.49698818e+00,\n",
       "         1.36111399e-01,  4.93419593e-01,  1.66775701e+00,\n",
       "         1.04373642e+00, -2.21714893e-01, -7.89695704e-01,\n",
       "         1.44044236e+00,  1.03801531e+00,  4.27686417e-01,\n",
       "        -2.21698786e+00,  1.26851887e+00,  3.24481027e-01,\n",
       "         7.59094740e-01,  2.82164963e-01, -8.49353394e-01,\n",
       "        -6.70913599e-01,  6.44345440e-01,  2.03101133e+00,\n",
       "        -5.96987921e-01, -1.12649289e+00,  1.80092452e+00,\n",
       "        -3.79460248e-01, -2.94703879e-01,  1.29845023e+00,\n",
       "        -6.12085457e-01,  1.96763248e+00, -3.61165788e-01,\n",
       "         1.24231905e-01, -1.94752652e-01,  8.36834039e-01,\n",
       "         3.24415310e-01,  2.28135750e-01, -1.61559523e-01,\n",
       "         3.67102072e-01, -1.04785585e+00,  1.05737271e+00,\n",
       "        -4.67284346e-01, -2.57522720e-01, -2.16788859e+00,\n",
       "         6.64140498e-01,  3.22246541e-01, -4.67958547e-01,\n",
       "         3.40826764e-01, -9.55113787e-01],\n",
       "       [-1.32312253e+00, -1.20350635e-01,  1.33416615e-01,\n",
       "        -8.33206794e-01,  1.55268195e+00, -6.15462021e-02,\n",
       "        -1.61503124e+00,  7.91432053e-01,  1.26477803e+00,\n",
       "         3.60993665e-02,  6.17310152e-01, -7.94225272e-01,\n",
       "         2.19999806e-01,  6.06218093e-01,  1.06991104e+00,\n",
       "        -2.71974065e+00,  2.02167939e+00,  4.12312383e-01,\n",
       "        -1.74954640e+00,  3.28785318e-01,  8.65118515e-01,\n",
       "         2.37392372e-01, -3.06925247e-01,  8.14927305e-01,\n",
       "         1.26409186e+00,  7.46695558e-01,  2.41719281e+00,\n",
       "        -4.18035827e-01,  9.31306124e-01, -3.97951762e-01,\n",
       "        -1.24037927e-01, -1.48761868e-01, -6.31184736e-01,\n",
       "        -6.11284935e-01,  7.57798669e-01,  7.97164130e-01,\n",
       "         2.08105287e-01,  5.62379513e-01,  8.33988682e-01,\n",
       "         1.05300250e+00,  5.34237697e-01,  4.46866497e-01,\n",
       "        -2.75669231e+00, -9.62855242e-01,  2.35799620e-01,\n",
       "         9.06464636e-01, -9.16643890e-01, -7.45311482e-01,\n",
       "         1.07511013e+00,  4.66152968e-01],\n",
       "       [-5.04095713e-01, -2.22529887e-01, -2.91774726e-01,\n",
       "         9.50286063e-01,  9.73147634e-01,  5.79898424e-01,\n",
       "         3.01746189e-01,  1.31362712e+00, -9.44816352e-02,\n",
       "        -2.17826891e+00, -2.45497563e-01,  4.30497947e-01,\n",
       "         2.11681866e-01,  8.36068090e-01,  2.11260296e+00,\n",
       "        -4.47282208e-01,  5.55712677e-01, -3.72441035e-01,\n",
       "        -1.05124906e+00,  1.42840570e+00,  1.15902140e+00,\n",
       "         1.09006680e+00,  1.04626540e+00,  1.99524923e+00,\n",
       "         1.48219639e-01,  4.92114200e-01, -2.24438594e-01,\n",
       "         1.25808937e+00, -5.69054583e-01, -1.00186201e+00,\n",
       "        -2.55325536e-01,  1.05820308e+00,  4.75133789e-01,\n",
       "        -2.52470332e-01, -1.65689919e+00,  1.28996482e+00,\n",
       "         3.23656679e-01,  7.22772646e-01, -2.63122781e-01,\n",
       "         6.48566354e-01,  2.65726374e-01,  8.45616490e-01,\n",
       "        -2.32388741e-01,  6.60165226e-02, -6.98156675e-01,\n",
       "        -2.84782360e-01, -1.40552112e+00,  1.64780212e+00,\n",
       "        -5.17887173e-01,  2.05315957e-01],\n",
       "       [-1.80780137e+00,  8.89725395e-01,  9.26434558e-01,\n",
       "         3.65879100e-02, -1.03370242e+00, -6.94733278e-01,\n",
       "         6.00605342e-01,  6.20466410e-01, -4.08633169e-01,\n",
       "         7.49608743e-01,  4.93745415e-01,  3.77822420e-01,\n",
       "        -1.06752545e+00,  7.24496137e-01, -3.34167670e+00,\n",
       "        -1.82235033e+00,  5.77177241e-01,  1.03615946e+00,\n",
       "        -1.48001850e+00,  3.90446727e-01, -3.81320188e-01,\n",
       "         1.12500638e+00,  8.56379997e-01,  6.05959230e-01,\n",
       "         1.65572835e+00,  3.84014305e-01, -2.43668414e-01,\n",
       "        -1.19996098e+00,  6.41806932e-01, -1.46277814e-01,\n",
       "        -1.17035550e+00, -1.65680015e+00,  6.79318524e-01,\n",
       "         3.20076896e-01,  2.54099447e-01, -6.05031259e-01,\n",
       "        -4.06889143e-01, -8.51801056e-01, -4.66156663e-01,\n",
       "        -7.72026660e-02,  1.64846358e+00, -5.76866870e-02,\n",
       "        -1.64627640e+00, -3.29713452e-01,  5.02501223e-01,\n",
       "        -5.03370558e-02,  7.18900473e-02, -9.32592274e-01,\n",
       "        -9.37045083e-01,  6.64071768e-01],\n",
       "       [ 3.15277882e-01,  1.16884184e-01, -4.57401747e-01,\n",
       "         1.30911843e+00,  9.93860575e-01,  4.24219089e-01,\n",
       "        -1.20480240e+00, -1.83556499e-01, -2.50955018e+00,\n",
       "        -1.74831135e+00, -7.62597610e-02, -6.56379930e-01,\n",
       "        -4.87708000e-02, -1.05473262e-01, -1.50802560e+00,\n",
       "         6.62482804e-01, -3.16175594e-01,  2.31763605e-01,\n",
       "        -3.43825808e-01,  6.44370025e-01,  1.51031064e+00,\n",
       "         6.14542361e-02,  7.77246612e-01, -2.50315165e-01,\n",
       "         9.37517588e-01,  1.49962947e+00,  2.48481252e-01,\n",
       "         9.57360925e-01,  1.60857614e+00, -3.09020286e-01,\n",
       "        -9.94004582e-01, -8.01389413e-01, -5.56557739e-01,\n",
       "         1.70836331e+00, -3.09458320e-01, -2.14317139e-01,\n",
       "        -1.49437567e-01, -2.77788374e+00,  9.17186988e-01,\n",
       "        -9.26608590e-01,  3.19011868e-01,  1.14425647e+00,\n",
       "        -8.27723820e-01,  3.90874653e-01, -1.34028706e+00,\n",
       "         1.71774414e-01,  1.32431038e+00, -1.58741552e+00,\n",
       "        -7.47988593e-01, -1.10258494e+00],\n",
       "       [ 9.95585639e-01, -2.09568814e-01, -9.98763880e-02,\n",
       "         4.28490060e-01,  2.72336570e-01,  1.92099543e+00,\n",
       "        -6.61949687e-01, -2.20822721e+00, -7.55094145e-01,\n",
       "         1.54229946e+00,  9.15167658e-01,  9.71402811e-01,\n",
       "         1.07004742e+00, -1.25072152e+00,  1.13191591e+00,\n",
       "         2.54226297e-01,  5.12947811e-01, -1.22638735e+00,\n",
       "        -2.37389532e-01, -1.73006831e-01, -8.39293418e-01,\n",
       "         4.61771466e-01,  1.46583810e-02, -6.89525138e-01,\n",
       "         5.54692180e-01, -8.91249175e-01, -4.57361945e-01,\n",
       "         2.59707885e-01,  7.77628864e-02,  1.04641886e+00,\n",
       "        -4.55967556e-01,  5.19446356e-01,  1.07885807e+00,\n",
       "         5.85036756e-01, -3.54067104e-01, -5.60432473e-01,\n",
       "        -4.78100002e-01,  1.00167643e+00, -5.69393017e-01,\n",
       "        -4.05067811e-01,  7.04101597e-01,  4.02698608e-01,\n",
       "         9.57996267e-01,  7.63399775e-01,  7.67470298e-01,\n",
       "         7.67419369e-01, -2.28383059e+00,  1.08901087e+00,\n",
       "         4.97639323e-03,  1.39445510e+00],\n",
       "       [ 1.12136081e+00, -2.29427581e+00, -1.01927270e+00,\n",
       "         1.53227278e-01,  3.27510390e-01, -3.73982784e-01,\n",
       "         1.17796402e+00, -1.24116590e+00, -1.81604043e+00,\n",
       "         3.32085023e-01, -6.48280687e-01, -2.52863924e+00,\n",
       "        -1.12763960e+00,  5.72367884e-02, -1.07637682e+00,\n",
       "         9.52684341e-01, -5.25800170e-01,  1.24122542e+00,\n",
       "        -1.88088594e+00,  2.90764062e-01,  9.50269549e-01,\n",
       "        -5.19057702e-01, -1.61482307e-01, -3.75565386e-01,\n",
       "         4.50934297e-01, -1.61115392e+00,  1.74783422e-01,\n",
       "         7.73324984e-01, -1.05802600e-01, -8.63581982e-01,\n",
       "         4.42824512e-01, -1.41238630e+00,  6.15058728e-01,\n",
       "        -1.39548295e+00, -7.69452714e-01,  5.22574311e-01,\n",
       "         2.15305660e+00, -8.26003460e-01,  3.56906111e-01,\n",
       "         1.79968927e+00, -2.75354609e-01, -1.61436684e+00,\n",
       "         9.11029770e-01,  8.67431507e-02,  1.80097985e+00,\n",
       "        -3.67894092e-02, -6.54226045e-01, -1.76532218e+00,\n",
       "         1.14349954e-02,  4.80689860e-01],\n",
       "       [-7.35614507e-01, -6.71029799e-01,  7.48173526e-01,\n",
       "        -1.62214055e+00, -1.06491919e+00, -1.81001594e-01,\n",
       "        -1.21139939e-01, -6.76062146e-01, -1.21224377e+00,\n",
       "        -1.73213271e+00, -5.87403949e-01,  6.32324534e-01,\n",
       "        -1.32504766e+00,  3.95659241e-01, -1.79953873e-01,\n",
       "         9.99465910e-01, -3.33508462e-01,  4.17101454e-01,\n",
       "         3.27034345e-01, -5.74724825e-01, -6.10595786e-01,\n",
       "        -8.47777150e-01, -5.94249218e-01, -7.51479140e-01,\n",
       "         2.08583740e-01, -1.51831304e-01,  2.04665105e-01,\n",
       "        -5.28112656e-01, -5.07141233e-01,  5.23172560e-01,\n",
       "         9.63201263e-01,  1.70266136e+00, -1.61996576e+00,\n",
       "        -1.29023325e+00,  2.72358656e-01, -7.28288444e-01,\n",
       "         2.10277251e+00, -8.61253645e-01, -5.06593160e-01,\n",
       "        -6.67268993e-01, -1.03260029e+00, -1.10741115e+00,\n",
       "         1.70121629e-01,  9.29999090e-01, -4.90715150e-01,\n",
       "        -9.15301862e-01, -4.52757384e-01, -3.00216900e-01,\n",
       "         7.66240560e-01,  1.02455809e+00],\n",
       "       [-1.19890103e+00,  1.23864022e+00, -1.55493762e+00,\n",
       "         3.17758196e-01,  5.60890277e-01,  2.04195880e+00,\n",
       "        -6.86230070e-01, -4.70930813e-02,  1.91036977e+00,\n",
       "         4.74210097e-02,  1.18910991e-01,  1.24640520e+00,\n",
       "         7.08672039e-01,  6.76735956e-01, -6.99813134e-01,\n",
       "        -3.41998655e-01, -5.13446400e-01, -2.88538775e-01,\n",
       "         1.25856065e+00, -1.06754518e-01, -9.08031898e-01,\n",
       "         9.54611388e-01,  1.53216755e+00,  4.83289475e-01,\n",
       "         9.31091214e-01,  4.51477110e-01, -3.20506883e-01,\n",
       "         1.43138480e+00,  1.74427573e+00,  2.63887093e-01,\n",
       "        -5.43264869e-01, -6.47446043e-01,  3.70687043e-01,\n",
       "         1.49297199e+00,  7.40818547e-01, -1.33872002e+00,\n",
       "         6.57298148e-02,  1.35266634e+00,  1.52569441e-01,\n",
       "        -3.37209562e-01, -1.46969828e+00,  6.16009594e-01,\n",
       "        -1.65481928e+00, -2.37105882e-01, -1.04615481e+00,\n",
       "        -1.47426358e+00,  1.43545303e+00, -1.79914621e-01,\n",
       "        -3.19461432e-01, -9.55396955e-01],\n",
       "       [ 1.36109627e+00,  3.35116854e-02,  5.77918993e-01,\n",
       "         6.48653596e-02, -4.88910389e-01, -1.31621421e-01,\n",
       "        -8.50859410e-01, -1.12621137e+00, -5.68513885e-01,\n",
       "        -5.45002630e-02, -1.85610033e-01, -1.91709504e+00,\n",
       "         1.10235906e+00,  4.15893831e-01, -6.80834459e-01,\n",
       "         1.24494933e+00, -3.29298959e-01, -1.67773453e+00,\n",
       "        -8.68693932e-01,  1.85588110e+00,  1.43398252e+00,\n",
       "         6.34148574e-01,  7.46060256e-01, -1.76592422e+00,\n",
       "        -9.65693863e-01,  6.46189656e-01,  4.29979846e-01,\n",
       "        -1.19076439e+00,  1.61503753e+00, -9.70496611e-02,\n",
       "         3.17175952e-02,  1.37789889e+00,  1.11857197e+00,\n",
       "         2.44169113e-01,  4.37877369e-01,  3.32427506e-01,\n",
       "         3.70928636e-02, -1.22866877e+00,  8.11716613e-01,\n",
       "         7.13099927e-01, -2.49939240e+00, -5.65900089e-01,\n",
       "         1.23962966e+00, -3.56868877e-01, -1.07234926e+00,\n",
       "         7.02270542e-01, -7.27523236e-01, -3.23942775e-01,\n",
       "        -1.31643269e+00, -1.71716561e+00],\n",
       "       [-1.06463611e+00,  8.77668533e-01, -1.20761500e-01,\n",
       "         1.89642563e-01, -2.12761556e+00, -2.11703839e+00,\n",
       "        -4.87530045e-01, -1.93853423e+00, -2.41517073e-01,\n",
       "        -2.86753746e+00, -6.97538242e-01,  3.73140634e-01,\n",
       "         8.58046965e-01,  2.49733394e-01,  9.55056424e-01,\n",
       "         3.76198140e-01, -5.89008202e-01, -2.62146710e-01,\n",
       "         1.97022883e+00,  9.94737168e-01,  2.05562709e+00,\n",
       "        -1.58061213e+00,  9.28983745e-01,  8.84687431e-01,\n",
       "        -4.17545050e-02,  1.02011723e+00,  2.18382483e-01,\n",
       "         1.36854636e+00, -8.61006045e-01, -7.10036099e-02,\n",
       "         2.49593764e-01, -2.20901770e-01,  5.58863771e-01,\n",
       "        -2.30147247e-01,  5.34119004e-01, -8.21291019e-01,\n",
       "        -1.05871388e+00,  7.91315554e-01,  5.63536316e-01,\n",
       "         1.12140140e+00,  1.73230387e-01,  3.88822023e-01,\n",
       "         4.13665125e-01,  6.89937080e-01, -1.89338740e+00,\n",
       "        -8.97682425e-01,  6.27764619e-01,  1.06718148e+00,\n",
       "        -3.64760412e-01,  1.51789527e-01],\n",
       "       [-1.40108142e-01,  1.21527492e+00, -1.72072455e-01,\n",
       "        -9.99894684e-01, -9.28089556e-01, -1.43283830e-01,\n",
       "        -2.45886940e-01, -5.01442942e-01, -2.34023214e+00,\n",
       "        -1.58959250e-01, -1.20266375e+00, -1.59651820e+00,\n",
       "         3.55801234e-01, -1.10620787e+00,  7.64575240e-01,\n",
       "        -8.05837243e-01, -1.20919633e+00,  2.01695064e+00,\n",
       "        -1.68503836e-01, -7.29666340e-01,  4.43409830e-01,\n",
       "         1.44505971e+00,  9.46740829e-01,  3.22580667e+00,\n",
       "        -2.59045845e-01, -9.44602614e-01, -1.00702445e+00,\n",
       "        -9.59710416e-02,  2.68089885e-01, -5.26969908e-02,\n",
       "         2.27534282e-01, -6.60379937e-02, -3.04782372e-03,\n",
       "         1.16586511e+00, -3.44357614e-02,  5.24995059e-01,\n",
       "         5.07315437e-01,  1.16820991e+00,  1.60669052e+00,\n",
       "        -7.16231565e-01, -1.47824316e+00,  4.86354148e-01,\n",
       "        -1.41707387e+00, -9.61430200e-01,  1.06362468e+00,\n",
       "        -1.54500171e-02,  1.63673446e-01,  8.07681187e-02,\n",
       "         1.70963470e+00,  1.79125003e+00],\n",
       "       [-1.06667893e+00, -1.18290036e+00,  1.61194600e+00,\n",
       "         3.13908487e-01,  2.62114114e-02,  1.73006174e-01,\n",
       "         1.87814204e+00,  7.68283891e-01,  4.72375838e-01,\n",
       "         2.27878395e-01, -8.11310975e-01, -7.61557881e-01,\n",
       "        -2.07074895e-01,  7.20792012e-01,  1.77074016e+00,\n",
       "        -2.96524724e-01,  1.84576407e+00, -1.26989809e+00,\n",
       "         4.53957940e-01, -3.56335415e-01,  1.21893382e+00,\n",
       "         1.86855379e+00, -1.16799780e+00,  8.42976790e-01,\n",
       "         7.94082190e-01, -3.48967442e-01, -6.52915875e-01,\n",
       "        -4.33870230e-01, -1.11640125e+00, -9.03056024e-01,\n",
       "        -6.04220645e-01,  7.00066871e-01,  1.35458103e+00,\n",
       "        -2.04233306e+00,  2.45270614e+00, -1.46938033e-01,\n",
       "        -8.96348891e-02,  1.70177938e+00,  1.05806426e+00,\n",
       "        -2.77775196e-01, -1.68748241e+00,  2.10968618e+00,\n",
       "         7.21905262e-01,  1.24134805e+00, -5.28421039e-01,\n",
       "        -3.07115478e-01,  1.56517852e+00, -2.69017934e-01,\n",
       "        -1.85594226e+00,  1.37041093e+00]])"
      ]
     },
     "execution_count": 169,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.random.normal(0, 1, (20,l))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "f486c53b-f78a-4846-84f6-6ba97c90acdb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157],\n",
       "       [-1.28155157, -0.84162123, -0.52440051, -0.2533471 ,  0.        ,\n",
       "         0.2533471 ,  0.52440051,  0.84162123,  1.28155157]])"
      ]
     },
     "execution_count": 96,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lev = np.arange(0.1, 0.91, 0.1)\n",
    "np.array([[sps.norm(0,1).ppf(lev[j])for j in range(9)] for i in range(20)])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "ec9deb80-4b1e-44d9-9050-22c087304327",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[-1.22632763, -0.96757533, -0.39301757, -0.20397749,  0.14693889,\n",
       "         0.37491585,  0.6289771 ,  0.92455755,  1.38612635],\n",
       "       [-1.44296325, -0.92307548, -0.56156128, -0.39494026, -0.2664423 ,\n",
       "        -0.00636477,  0.30104914,  0.79924288,  1.24402695],\n",
       "       [-1.04964449, -0.70018076, -0.39034465, -0.2240184 , -0.01453115,\n",
       "         0.14606471,  0.33530056,  0.62722259,  1.30862775],\n",
       "       [-1.49909209, -1.0028768 , -0.79626747, -0.31251036,  0.03944439,\n",
       "         0.21273599,  0.39171022,  0.62138397,  1.10633739],\n",
       "       [-1.00312275, -0.5279426 , -0.15478898, -0.02036877,  0.10632089,\n",
       "         0.27521066,  0.5321973 ,  0.86913597,  1.00471078],\n",
       "       [-1.02707699, -0.59789934, -0.33801833,  0.11657606,  0.30406687,\n",
       "         0.40774515,  0.58181003,  0.84903717,  1.39213776],\n",
       "       [-1.44728498, -1.1295602 , -0.70792207, -0.47793317, -0.11071702,\n",
       "         0.15321368,  0.32667567,  0.83899428,  1.06471114],\n",
       "       [-0.97542639, -0.34560624, -0.14772612,  0.1749131 ,  0.3927516 ,\n",
       "         0.50725874,  0.72367107,  0.82940629,  1.00850274],\n",
       "       [-1.5037043 , -1.13048535, -0.60325476, -0.47765272, -0.09980087,\n",
       "         0.25815378,  0.38626593,  0.61657686,  1.34272723],\n",
       "       [-0.84478931, -0.59635643, -0.21940719, -0.05321533,  0.27148184,\n",
       "         0.45277276,  0.81611672,  1.21705014,  1.41001786],\n",
       "       [-0.84299222, -0.59341696, -0.50407804, -0.3477463 , -0.1978683 ,\n",
       "         0.16800661,  0.29112907,  0.83553183,  1.24473185],\n",
       "       [-1.33896942, -0.86399052, -0.58659088, -0.30205378, -0.08560411,\n",
       "         0.15951456,  0.32521032,  0.57569444,  1.31186808],\n",
       "       [-1.28206288, -1.00076582, -0.65249426, -0.34110119, -0.0706208 ,\n",
       "         0.16200371,  0.51191737,  0.69286209,  0.90702986],\n",
       "       [-1.31524971, -1.10426677, -0.8574561 , -0.52029216, -0.19252748,\n",
       "         0.15492195,  0.46874699,  0.8026502 ,  1.05731233],\n",
       "       [-0.99953722, -0.31769806, -0.20247038, -0.08195423,  0.02905979,\n",
       "         0.24167693,  0.52902993,  0.68477334,  0.98999741],\n",
       "       [-0.94768259, -0.6316389 , -0.21408991,  0.09606892,  0.3681682 ,\n",
       "         0.58867389,  0.72623814,  0.85587464,  1.2196952 ],\n",
       "       [-1.31023999, -0.88147138, -0.57809946, -0.36956493, -0.15188463,\n",
       "         0.1984757 ,  0.43363991,  0.68719483,  1.25402875],\n",
       "       [-1.34485825, -1.09924007, -0.84053182, -0.67301396, -0.19389305,\n",
       "         0.01162688,  0.11968165,  0.33932089,  0.86796034],\n",
       "       [-1.38601635, -0.87887224, -0.64766741, -0.37073421,  0.17733218,\n",
       "         0.43792077,  0.68759327,  0.82334529,  1.23852248],\n",
       "       [-1.61388065, -0.7082339 , -0.33398495, -0.02213554,  0.12303499,\n",
       "         0.29447909,  0.65797989,  0.94777721,  1.26470461]])"
      ]
     },
     "execution_count": 95,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = np.random.normal(0, 1, (20,l))\n",
    "\n",
    "def rprior(n):\n",
    "    means = np.random.uniform(-10,10,size = n)\n",
    "    res = [0]*n\n",
    "    for i in range(n):\n",
    "        res[i] = np.random.normal(means[i],1,l)\n",
    "    return(res,means)\n",
    "\n",
    "np.array([np.percentile(data[i], np.arange(10, 91, 10)) for i in range(20)])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "id": "c9d7dde6-c941-4cd4-8611-73cc077d9d60",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "156.34695097571228"
      ]
     },
     "execution_count": 119,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "l = 50\n",
    "data = np.random.normal(0, 1, (20,l))\n",
    "\n",
    "def rprior(n):\n",
    "    means = np.random.uniform(-10,10,size = n)\n",
    "    res = [0]*n\n",
    "    for i in range(n):\n",
    "        res[i] = np.random.normal(means[i],1,l)\n",
    "    return(res,means)\n",
    "\n",
    "statdata = np.array([np.percentile(data[i], np.arange(10, 91, 10)) for i in range(20)])\n",
    "\n",
    "def dprior(simu):\n",
    "    return(np.sum(norm.pdf(simu, loc=simu[1], scale=1)))\n",
    "\n",
    "def dist(simu):\n",
    "    lev = np.arange(0.1, 0.91, 0.1)\n",
    "    quantiles = np.array([[sps.norm(simu[i],1).ppf(lev[j])for j in range(9)] for i in range(20)])\n",
    "    return(np.sum(abs(quantiles - statdata)))\n",
    "\n",
    "dist(np.random.normal(0, 1, (l)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "4b29e06b-4451-4472-9fb0-60f8fe9f4b48",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([3, 3, 3])"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.tile([1,2,3],(3,1))[:,2]\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
